{"version":3,"sources":["webpack:///./src/$_lazy_route_resource lazy namespace object","webpack:///./src/app/app-routing.module.ts","webpack:///./src/app/app.component.css","webpack:///./src/app/app.component.html","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/board-cache.service.ts","webpack:///./src/app/board.service.ts","webpack:///./src/app/button-page/button-page.component.css","webpack:///./src/app/button-page/button-page.component.html","webpack:///./src/app/button-page/button-page.component.ts","webpack:///./src/app/config-guard.service.ts","webpack:///./src/app/config-page/config-page.component.css","webpack:///./src/app/config-page/config-page.component.html","webpack:///./src/app/config-page/config-page.component.ts","webpack:///./src/app/config.service.ts","webpack:///./src/app/custom-validation.ts","webpack:///./src/app/error-page/error-page.component.css","webpack:///./src/app/error-page/error-page.component.html","webpack:///./src/app/error-page/error-page.component.ts","webpack:///./src/app/error.service.ts","webpack:///./src/app/errors.ts","webpack:///./src/app/global-error-handler.service.ts","webpack:///./src/app/interaction-event-handler.directive.ts","webpack:///./src/app/main-page/main-page.component.css","webpack:///./src/app/main-page/main-page.component.html","webpack:///./src/app/main-page/main-page.component.ts","webpack:///./src/app/obf-button/obf-button.component.css","webpack:///./src/app/obf-button/obf-button.component.html","webpack:///./src/app/obf-button/obf-button.component.ts","webpack:///./src/app/obfboard.ts","webpack:///./src/app/obfpage/obfpage.component.ts","webpack:///./src/app/obz.service.ts","webpack:///./src/app/obzboard-set.ts","webpack:///./src/app/progress.service.ts","webpack:///./src/app/progress/progress.component.css","webpack:///./src/app/progress/progress.component.html","webpack:///./src/app/progress/progress.component.ts","webpack:///./src/app/scanning.service.ts","webpack:///./src/app/speechbar.service.ts","webpack:///./src/app/speechbar/speechbar.component.css","webpack:///./src/app/speechbar/speechbar.component.html","webpack:///./src/app/speechbar/speechbar.component.ts","webpack:///./src/app/url-utils.ts","webpack:///./src/environments/environment.ts","webpack:///./src/environments/version.ts","webpack:///./src/main.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error('Cannot find module \"' + req + '\".');\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { ConfigGuardService } from './config-guard.service';\r\nimport { ConfigPageComponent } from './config-page/config-page.component';\r\nimport { MainPageComponent } from './main-page/main-page.component';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { ErrorPageComponent } from './error-page/error-page.component';\r\n\r\nconst routes: Routes = [\r\n  { path: 'main', component: MainPageComponent, canActivate: [ConfigGuardService] },\r\n  { path: 'config', component: ConfigPageComponent },\r\n  { path: 'error', component: ErrorPageComponent },\r\n  { path: '', redirectTo: '/main', pathMatch: 'full' },\r\n  { path: '**', component: MainPageComponent, canActivate: [ConfigGuardService] }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    RouterModule.forRoot(routes, {useHash: true}),\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    RouterModule\r\n  ],\r\n  declarations: []\r\n})\r\nexport class AppRoutingModule { }\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<router-outlet></router-outlet>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.css']\r\n})\r\nexport class AppComponent {\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport 'hammerjs';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { NgModule, ErrorHandler } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { LayoutModule } from '@angular/cdk/layout';\r\n\r\nimport { MatMenuModule, MatIconModule, MatButtonModule, MatInputModule, MatRippleModule, MatGridListModule, MatCardModule,\r\n  MatFormFieldModule, MatCheckboxModule, MatSnackBarModule, MatTabsModule, MatSliderModule, MatRadioModule,\r\n  MatSelectModule } from '@angular/material';\r\n\r\nimport { WebStorageModule } from 'ngx-store';\r\n\r\nimport { AppComponent } from './app.component';\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { ButtonPageComponent } from './button-page/button-page.component';\r\nimport { ConfigPageComponent } from './config-page/config-page.component';\r\nimport { MainPageComponent } from './main-page/main-page.component';\r\nimport { ObfButtonComponent } from './obf-button/obf-button.component';\r\nimport { SpeechbarComponent } from './speechbar/speechbar.component';\r\nimport { GlobalErrorHandlerService } from './global-error-handler.service';\r\nimport { ErrorPageComponent } from './error-page/error-page.component';\r\nimport { OBFPageComponent } from './obfpage/obfpage.component';\r\nimport { ProgressComponent } from './progress/progress.component';\r\nimport { InteractionEventHandlerDirective } from './interaction-event-handler.directive';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    ButtonPageComponent,\r\n    SpeechbarComponent,\r\n    ConfigPageComponent,\r\n    MainPageComponent,\r\n    ObfButtonComponent,\r\n    ErrorPageComponent,\r\n    OBFPageComponent,\r\n    ProgressComponent,\r\n    InteractionEventHandlerDirective\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    BrowserAnimationsModule,\r\n    FormsModule,\r\n    HttpClientModule,\r\n    MatGridListModule,\r\n    MatCardModule,\r\n    MatFormFieldModule,\r\n    MatCheckboxModule,\r\n    MatMenuModule,\r\n    MatIconModule,\r\n    MatInputModule,\r\n    MatButtonModule,\r\n    MatSnackBarModule,\r\n    MatTabsModule,\r\n    LayoutModule,\r\n    AppRoutingModule,\r\n    WebStorageModule,\r\n    MatRippleModule,\r\n    MatSliderModule,\r\n    MatRadioModule,\r\n    MatSelectModule\r\n  ],\r\n  providers: [\r\n    {\r\n      provide: ErrorHandler, useClass: GlobalErrorHandlerService\r\n    }\r\n  ],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { LocalStorage } from '@ngx-pwa/local-storage';\r\nimport { OBZBoardSet } from './obzboard-set';\r\nimport { Observable } from 'rxjs';\r\nimport { map, first } from 'rxjs/operators';\r\nimport { OBFBoard } from './obfboard';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class BoardCacheService {\r\n\r\n  private static BOARD_CACHE_KEY = 'ovfCurrentBoard';\r\n\r\n  constructor(private localStorage: LocalStorage) { }\r\n\r\n  public clear(): Observable<boolean> {\r\n    this.log('Clearing local board cache');\r\n    return this.localStorage.removeItem(BoardCacheService.BOARD_CACHE_KEY).pipe(first());\r\n  }\r\n\r\n  public retrieve(): Observable<OBZBoardSet> {\r\n    return this.localStorage.getItem(BoardCacheService.BOARD_CACHE_KEY).pipe(map(data => {\r\n      if (data) {\r\n        this.log('Successfully loaded board from cache');\r\n\r\n        // TODO: move this to static method inside OBZBoardSet?\r\n        const bs = new OBZBoardSet();\r\n        bs.rootBoardKey = data.rootBoardKey;\r\n        data.images.forEach((value: Blob, key: string) => {\r\n          bs.setImage(key, value);\r\n        });\r\n        data.sounds.forEach((value: string, key: string) => {\r\n          bs.setSound(key, value);\r\n        });\r\n        data.boards.forEach((value: object, key: string) => {\r\n          const board = new OBFBoard().deserialize(value);\r\n          board.setImageResolver(bs);\r\n          board.setSoundResolver(bs);\r\n          bs.setBoard(key, board);\r\n        });\r\n        return bs;\r\n      } else {\r\n        this.log('Cache is empty');\r\n        throw new Error('Cache is empty');\r\n      }\r\n    }), first());\r\n  }\r\n\r\n  public save(boardSet: OBZBoardSet): Observable<OBZBoardSet> {\r\n    return this.localStorage.setItem(BoardCacheService.BOARD_CACHE_KEY, boardSet).pipe(\r\n      map(success => boardSet),\r\n      first()\r\n    );\r\n  }\r\n\r\n  private log(message: string) {\r\n    console.log(`BoardCacheService: ${message}`);\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { ObzService } from './obz.service';\r\nimport { Observable, Observer } from 'rxjs';\r\nimport { OBFBoard } from './obfboard';\r\nimport { OBZBoardSet } from './obzboard-set';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class BoardService {\r\n  private boardSet: OBZBoardSet;\r\n  private currentBoardKey: string;\r\n  private observer: Observer<OBFBoard>;\r\n\r\n  constructor(private obzService: ObzService) {}\r\n\r\n  private addObserver = (observer: Observer<OBFBoard>) => {\r\n    this.observer = observer;\r\n    this.obzService.getBoardSet().subscribe(boardSet => {\r\n      this.setBoardSet(boardSet);\r\n    });\r\n  }\r\n\r\n  private setBoardSet(boardSet: OBZBoardSet) {\r\n    this.boardSet = boardSet;\r\n    this.currentBoardKey = boardSet.rootBoardKey;\r\n    this.home();\r\n  }\r\n\r\n  getBoard(): Observable<OBFBoard> {\r\n    return new Observable<OBFBoard>(this.addObserver);\r\n  }\r\n\r\n  navigateToBoard(boardKey: string) {\r\n    this.currentBoardKey = boardKey;\r\n    const board = this.boardSet.getBoard(this.currentBoardKey);\r\n    this.observer.next(board);\r\n  }\r\n\r\n  navigateToExternalBoard(boardKey: string) {\r\n    this.obzService.loadBoardSet(boardKey);\r\n  }\r\n\r\n  home() {\r\n    this.navigateToBoard(this.boardSet.rootBoardKey);\r\n  }\r\n}\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\n.board {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  height: 100%;\\r\\n}\\n.boardRow {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n  flex: 1 1 auto;\\r\\n  overflow: hidden;\\r\\n}\\n.boardButton {\\r\\n  flex: 1 1 auto;\\r\\n  width: 100%;\\r\\n}\\n.scanHighlight {\\r\\n  position: relative;\\r\\n}\\n.scanHighlight:after {\\r\\n  border: greenyellow solid 5px;\\r\\n  content: \\\" \\\";\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n  bottom: 0;\\r\\n}\\n.scanSelect {\\r\\n  position: relative;\\r\\n}\\n.scanSelect:after {\\r\\n  border: blue solid 5px;\\r\\n  content: \\\" \\\";\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n  bottom: 0;\\r\\n}\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<div class=\\\"board\\\" *ngIf=\\\"board; else noBoard\\\">\\r\\n  <div class=\\\"boardRow\\\"\\r\\n      *ngFor=\\\"let row of buttonProvider.getScannableCollections()\\\"\\r\\n      [class.scanHighlight]=\\\"row.isHighlighted()\\\"\\r\\n      [class.scanSelect]=\\\"row.isSelection()\\\"\\r\\n      [style.height]=\\\"row.rowHeight\\\">\\r\\n    <div class=\\\"boardButton\\\"\\r\\n        *ngFor=\\\"let butt of row.displayButtons\\\"\\r\\n        [class.scanHighlight]=\\\"butt && butt.isHighlighted()\\\"\\r\\n        [class.scanSelect]=\\\"butt && butt.isSelection()\\\">\\r\\n      <app-obf-button *ngIf=\\\"butt\\\" [butt]=\\\"butt.button\\\" [clickHandler]=\\\"handleButtonClick.bind(this)\\\"></app-obf-button>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\\r\\n\\r\\n<ng-template #noBoard>\\r\\n  <app-progress></app-progress>\\r\\n</ng-template>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit, Output, OnDestroy } from '@angular/core';\r\nimport { BoardService } from '../board.service';\r\nimport { SpeechbarService } from '../speechbar.service';\r\nimport { OBFBoard, Button, LoadBoardAction } from '../obfboard';\r\nimport { Subscription, Subscriber } from 'rxjs';\r\nimport { ScanningService, ScanningModel, ScannableCollectionProvider, ScannableCollection, Scannable } from '../scanning.service';\r\nimport { ConfigService } from '../config.service';\r\n\r\nclass ScannableButton extends Scannable {\r\n  static TYPE = 'OBFButton';\r\n  private _button: Button;\r\n  private provider: ScannableButtonRowProvider;\r\n\r\n  constructor(provider: ScannableButtonRowProvider, button: Button, priority: number) {\r\n    super(priority, ScannableButton.TYPE);\r\n    this._button = button;\r\n    this.provider = provider;\r\n  }\r\n\r\n  get button(): Button {\r\n    return this._button;\r\n  }\r\n\r\n  set button(button: Button) {\r\n    this._button = button;\r\n  }\r\n\r\n  isHighlighted(): boolean {\r\n    return this.provider.getScanningHighlight() === this;\r\n  }\r\n\r\n  isSelection(): boolean {\r\n    return this.provider.getScanningSelection() === this;\r\n  }\r\n}\r\n\r\nclass ScannableButtonRow extends ScannableCollection {\r\n  static TYPE = 'OBFButtonRow';\r\n  private provider: ScannableButtonRowProvider;\r\n  displayButtons = [];\r\n  rowHeight: string;\r\n\r\n  constructor(provider: ScannableButtonRowProvider, board: OBFBoard, row: string[], priority: number, rowHeight: string) {\r\n    super(priority, ScannableButtonRow.TYPE);\r\n    this.provider = provider;\r\n    this.rowHeight = rowHeight;\r\n\r\n    row.forEach((buttonId, index) => {\r\n      if (buttonId) {\r\n        const button = new ScannableButton(provider, board.getButton(buttonId), index);\r\n        this.addChild(button);\r\n        this.displayButtons.push(button);\r\n      } else {\r\n        this.displayButtons.push(undefined);\r\n      }\r\n    });\r\n  }\r\n\r\n  isHighlighted(): boolean {\r\n    return this.provider.getScanningHighlight() === this;\r\n  }\r\n\r\n  isSelection(): boolean {\r\n    return this.provider.getScanningSelection() === this;\r\n  }\r\n}\r\n\r\nclass ScannableButtonRowProvider extends Subscriber<ScanningModel> implements ScannableCollectionProvider {\r\n  private rows: ScannableButtonRow[];\r\n  private scanningModel: ScanningModel;\r\n\r\n  constructor(board: OBFBoard, buttonPressHandler: (Button) => void) {\r\n    super((scanningModel: ScanningModel) => {\r\n      this.scanningModel = scanningModel;\r\n\r\n      if (this.scanningModel.currentSelection && this.scanningModel.currentSelection.type === ScannableButton.TYPE) {\r\n        const button = (<ScannableButton>this.scanningModel.currentSelection).button;\r\n        buttonPressHandler(button);\r\n      }\r\n    });\r\n    const rowHeight = (100 / board.grid.rows).toString() + '%';\r\n    this.rows = board.grid.order.map((row, index) => new ScannableButtonRow(this, board, row, index + 1, rowHeight));\r\n  }\r\n\r\n  getScannableCollections(): ScannableCollection[] {\r\n    return this.rows;\r\n  }\r\n\r\n  getScanningHighlight(): Scannable {\r\n    return this.scanningModel && this.scanningModel.currentHighlight;\r\n  }\r\n\r\n  getScanningSelection(): Scannable {\r\n    return this.scanningModel && this.scanningModel.currentSelection;\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: 'app-button-page',\r\n  templateUrl: './button-page.component.html',\r\n  styleUrls: ['./button-page.component.css']\r\n})\r\nexport class ButtonPageComponent implements OnInit, OnDestroy {\r\n\r\n  @Output()\r\n  board: OBFBoard;\r\n\r\n  private boardSubscription: Subscription;\r\n  private scanningSubscription: Subscription;\r\n  private buttonProvider: ScannableButtonRowProvider;\r\n\r\n  actionPerformers: {[key: string]: () => void} = {\r\n    ':clear' : this.speechbarService.clear.bind(this.speechbarService),\r\n    ':backspace' : this.speechbarService.backspace.bind(this.speechbarService),\r\n    ':speak' : this.speechbarService.speak.bind(this.speechbarService),\r\n    ':home' : this.boardService.home.bind(this.boardService),\r\n    ':space': this.speechbarService.space.bind(this.speechbarService)\r\n  };\r\n\r\n  constructor(private boardService: BoardService, private speechbarService: SpeechbarService,\r\n    private scanningService: ScanningService, private configService: ConfigService) { }\r\n\r\n  ngOnInit() {\r\n    this.loadBoard();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.boardSubscription) {\r\n      this.boardSubscription.unsubscribe();\r\n    }\r\n\r\n    if (this.scanningSubscription) {\r\n      this.scanningSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  loadBoard(): void {\r\n    this.boardSubscription = this.boardService.getBoard().subscribe(this.setBoard);\r\n  }\r\n\r\n  private setBoard = (board: OBFBoard) => {\r\n    if (this.scanningSubscription) {\r\n      this.scanningSubscription.unsubscribe();\r\n    }\r\n    this.board = board;\r\n    this.registerWithScanner();\r\n  }\r\n\r\n  registerWithScanner(): void {\r\n    this.buttonProvider = new ScannableButtonRowProvider(this.board, this.handleButtonClick.bind(this));\r\n    this.scanningSubscription = this.scanningService.getScanningModel().subscribe(this.buttonProvider);\r\n  }\r\n\r\n  handleButtonClick(button: Button) {\r\n    let soundToPlay = false;\r\n\r\n    if (button.soundId) {\r\n      const sound = this.board.getSound(button.soundId);\r\n\r\n      if (sound) {\r\n        const soundSource = sound.getSource();\r\n\r\n        if (soundSource) {\r\n          soundToPlay = true;\r\n          const audioSound = new Audio(soundSource);\r\n          audioSound.play();\r\n        }\r\n      }\r\n    }\r\n\r\n    let addToSpeechBar = true;\r\n    if (button.actions.length > 0) {\r\n      button.actions.forEach(action => this.performAction(button, action));\r\n      addToSpeechBar = false;\r\n    }\r\n\r\n    if (button.loadBoardAction) {\r\n      const loadBoardAction: LoadBoardAction = button.loadBoardAction;\r\n\r\n      if (loadBoardAction.path) {\r\n        this.boardService.navigateToBoard(loadBoardAction.path);\r\n      } else if (loadBoardAction.dataUrl) {\r\n        this.boardService.navigateToExternalBoard(loadBoardAction.dataUrl);\r\n      } else if (loadBoardAction.url) {\r\n        // TODO: redirect whole page to site!\r\n      }\r\n\r\n      // at this point we would still be adding things to the speech bar\r\n      // we only want to do this if there is a vocalisation\r\n      // so if there isn't a vocalisation; set addToSpeechBar to false\r\n      if (!button.vocalization) {\r\n        addToSpeechBar = false;\r\n      }\r\n    }\r\n\r\n    if (addToSpeechBar) {\r\n      this.speechbarService.addButton(button);\r\n\r\n      // don't say the button if there's also a sound... that'd be weird...\r\n      if (!soundToPlay && this.configService.buttonBehaviourConfig.speakOnTrigger) {\r\n        this.speechbarService.sayButton(button);\r\n      }\r\n    }\r\n  }\r\n\r\n  performAction(button: Button, action: string) {\r\n\r\n    if (action.startsWith('+')) {\r\n      this.speechbarService.appendButton(button, action);\r\n    } else {\r\n      const actionPerformer = this.actionPerformers[action];\r\n\r\n      if (actionPerformer) {\r\n        actionPerformer();\r\n      } else {\r\n        console.log('Unsupported action: ' + action);\r\n      }\r\n    }\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { CanActivate, Router, RouterStateSnapshot, ActivatedRouteSnapshot } from '@angular/router';\r\nimport { ConfigService } from './config.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ConfigGuardService implements CanActivate {\r\n\r\n  constructor(private router: Router, private config: ConfigService) { }\r\n\r\n  canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\r\n    // TODO: check more config and possibly validate it\r\n    const hasConfig = this.config.boardURL;\r\n    if (hasConfig) {\r\n      return true;\r\n    } else {\r\n      console.log('Redirecting to /config due to no config');\r\n      this.router.navigate(['/config']);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\r\\n.formTitle {\\r\\n  height: 100%;\\r\\n  background-color: #e0e0e0;\\r\\n  padding: 10px;\\r\\n}\\r\\n.formCard {\\r\\n  padding: 0px;\\r\\n}\\r\\n.formContainer {\\r\\n  padding: 20px;\\r\\n}\\r\\n.formInputUrl, .formInputSelection {\\r\\n  width: 100%;\\r\\n}\\r\\n.formInputField {\\r\\n  width: 100%;\\r\\n  padding-right: 10px;\\r\\n}\\r\\n.formLabel {\\r\\n  white-space: normal;\\r\\n}\\r\\n.formButtons {\\r\\n  padding: 5px;\\r\\n  display: flex;\\r\\n  justify-content: flex-end;\\r\\n}\\r\\n.clickable {\\r\\n  cursor: pointer;\\r\\n}\\r\\n.clickable, i {\\r\\n  position: relative;\\r\\n  top: 6px;\\r\\n}\\r\\n.borderExample {\\r\\n  border: solid black;\\r\\n  width: -webkit-fit-content;\\r\\n  width: -moz-fit-content;\\r\\n  width: fit-content;\\r\\n  display: inline-block;\\r\\n}\\r\\n.invalidTab {\\r\\n  color: red;\\r\\n}\\r\\nmat-radio-button {\\r\\n  padding: 25px;\\r\\n}\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<app-obfpage>\\r\\n  <mat-card class=\\\"formCard\\\">\\r\\n    <div class=\\\"formTitle\\\">\\r\\n      Configuration\\r\\n    </div>\\r\\n    <form (ngSubmit)=\\\"save()\\\" #configForm=\\\"ngForm\\\">\\r\\n\\r\\n      <div class=\\\"formButtons\\\">\\r\\n        <button type=\\\"submit\\\" mat-raised-button color=\\\"primary\\\" [disabled]=\\\"!configForm.form.valid\\\">Save</button>\\r\\n      </div>\\r\\n      <mat-tab-group>\\r\\n        <mat-tab ngModelGroup=\\\"boardURL\\\" #boardURLCtrl=\\\"ngModelGroup\\\">\\r\\n          <ng-template mat-tab-label>\\r\\n            <mat-icon *ngIf=\\\"boardURLCtrl.invalid\\\" class=\\\"invalidTab\\\">error</mat-icon>\\r\\n            <span [class.invalidTab]=\\\"boardURLCtrl.invalid\\\" name=\\\"boardURL\\\">Board URL</span>\\r\\n          </ng-template>\\r\\n          <div class=\\\"formContainer\\\">\\r\\n            <mat-card>\\r\\n              <mat-form-field class=\\\"formInputField\\\">\\r\\n                <input [(ngModel)]=\\\"boardURL\\\" required matInput name=\\\"boardURL\\\" placeholder=\\\"URL for obf/obz file\\\" class=\\\"formInputUrl\\\">\\r\\n              </mat-form-field>\\r\\n              <div class=\\\"clickable\\\" (click)=\\\"copyToClipboard()\\\"><i class=\\\"material-icons\\\">link</i>&nbsp;Create link</div>\\r\\n            </mat-card>\\r\\n          </div>\\r\\n        </mat-tab>\\r\\n        <mat-tab ngModelGroup=\\\"speechbarBehaviour\\\" #speechbarBehaviourCtrl=\\\"ngModelGroup\\\">\\r\\n          <ng-template mat-tab-label>\\r\\n            <mat-icon *ngIf=\\\"speechbarBehaviourCtrl.invalid\\\" class=\\\"invalidTab\\\">error</mat-icon>\\r\\n            <span [class.invalidTab]=\\\"speechbarBehaviourCtrl.invalid\\\" name=\\\"speechbarBehaviour\\\">Speechbar behaviour</span>\\r\\n          </ng-template>\\r\\n          <div class=\\\"formContainer\\\">\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"speakOnSpeechbarClick\\\" name=\\\"speakOnSpeechbarClick\\\">\\r\\n                <span class=\\\"formLabel\\\">Speak when speechbar is clicked</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"showIconsInSpeechbar\\\" name=\\\"showIconsInSpeechbar\\\">\\r\\n                <span class=\\\"formLabel\\\">Display button images and labels in speechbar (instead of vocalisation text)</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n          </div>\\r\\n        </mat-tab>\\r\\n        <mat-tab ngModelGroup=\\\"buttonBehaviour\\\" #buttonBehaviourCtrl=\\\"ngModelGroup\\\">\\r\\n          <ng-template mat-tab-label>\\r\\n            <mat-icon *ngIf=\\\"buttonBehaviourCtrl.invalid\\\" class=\\\"invalidTab\\\">error</mat-icon>\\r\\n            <span [class.invalidTab]=\\\"buttonBehaviourCtrl.invalid\\\" name=\\\"buttonBehaviour\\\">Button press behaviour</span>\\r\\n          </ng-template>\\r\\n          <div class=\\\"formContainer\\\">\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"buttonBehaviourConfig.speakOnTrigger\\\" name=\\\"buttonBehaviourConfig.speakOnTrigger\\\">\\r\\n                <span class=\\\"formLabel\\\">Speak when button is pressed (as well as adding to speechbar)</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n            <mat-card>\\r\\n              <mat-radio-group [(ngModel)]=\\\"buttonBehaviourConfig.triggerEvent\\\" name=\\\"buttonBehaviourConfig.triggerEvent\\\">\\r\\n                <div class=\\\"formLabel\\\">Event to use to trigger button usage</div>\\r\\n                <mat-radio-button [value]=\\\"interactionEventType.click\\\">Full click</mat-radio-button>\\r\\n                <mat-radio-button [value]=\\\"interactionEventType.mouseup\\\">Release</mat-radio-button>\\r\\n                <mat-radio-button [value]=\\\"interactionEventType.mousedown\\\">Press</mat-radio-button>\\r\\n              </mat-radio-group>\\r\\n            </mat-card>\\r\\n          </div>\\r\\n        </mat-tab>\\r\\n        <mat-tab ngModelGroup=\\\"displayedButtons\\\" #displayedButtonsCtrl=\\\"ngModelGroup\\\">\\r\\n          <ng-template mat-tab-label>\\r\\n            <mat-icon *ngIf=\\\"displayedButtonsCtrl.invalid\\\" class=\\\"invalidTab\\\">error</mat-icon>\\r\\n            <span [class.invalidTab]=\\\"displayedButtonsCtrl.invalid\\\" name=\\\"displayedButtons\\\">Permanent buttons</span>\\r\\n          </ng-template>\\r\\n          <div class=\\\"formContainer\\\">\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"displayedButtons.showSpeakButton\\\" name=\\\"showSpeakButton\\\">\\r\\n                <span class=\\\"formLabel\\\">Speak button always shown</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"displayedButtons.showBackspaceButton\\\" name=\\\"showBackspaceButton\\\">\\r\\n                <span class=\\\"formLabel\\\">Backspace button always shown</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"displayedButtons.showClearButton\\\" name=\\\"showClearButton\\\">\\r\\n                <span class=\\\"formLabel\\\">Clear button always shown</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"displayedButtons.showHomeButton\\\" name=\\\"showHomeButton\\\">\\r\\n                <span class=\\\"formLabel\\\">Home button always shown</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n          </div>\\r\\n        </mat-tab>\\r\\n        <mat-tab ngModelGroup=\\\"voiceConfig\\\" #voiceConfigCtrl=\\\"ngModelGroup\\\">\\r\\n          <ng-template mat-tab-label>\\r\\n            <mat-icon *ngIf=\\\"voiceConfigCtrl.invalid\\\" class=\\\"invalidTab\\\">error</mat-icon>\\r\\n            <span [class.invalidTab]=\\\"voiceConfigCtrl.invalid\\\" name=\\\"voiceConfig\\\">Voice Settings</span>\\r\\n          </ng-template>\\r\\n          <div class=\\\"formContainer\\\">\\r\\n            <mat-card>\\r\\n              <mat-form-field class=\\\"formInputSelection\\\">\\r\\n                <mat-select [(ngModel)]=\\\"voiceConfig.userVoice\\\" name=\\\"userVoice\\\" placeholder=\\\"User Voice\\\">\\r\\n                  <mat-option>Use default</mat-option>\\r\\n                  <mat-option *ngFor=\\\"let voice of availableVoices()\\\" [value]=\\\"voice.voiceURI\\\">\\r\\n                    {{voice.name + \\\" (\\\" + voice.lang +\\\")\\\"}}\\r\\n                  </mat-option>\\r\\n                </mat-select>\\r\\n              </mat-form-field>\\r\\n            </mat-card>\\r\\n          </div>\\r\\n        </mat-tab>\\r\\n        <mat-tab ngModelGroup=\\\"scanning\\\" #scanningCtrl=\\\"ngModelGroup\\\">\\r\\n          <ng-template mat-tab-label>\\r\\n            <mat-icon *ngIf=\\\"scanningCtrl.invalid\\\" class=\\\"invalidTab\\\">error</mat-icon>\\r\\n            <span [class.invalidTab]=\\\"scanningCtrl.invalid\\\" name=\\\"scanning\\\">Scanning</span>\\r\\n          </ng-template>\\r\\n          <div class=\\\"formContainer\\\">\\r\\n            <mat-card>\\r\\n              <mat-checkbox [(ngModel)]=\\\"scanningConfig.enabled\\\" name=\\\"scanningEnabled\\\">\\r\\n                <span class=\\\"formLabel\\\">Enable scanning</span>\\r\\n              </mat-checkbox>\\r\\n            </mat-card>\\r\\n            <mat-card>\\r\\n              <mat-form-field class=\\\"formInputField\\\">\\r\\n                <input [required]=\\\"scanningConfig.enabled\\\" type=\\\"number\\\" [(ngModel)]=\\\"scanningConfig.time\\\" name=\\\"scanningTime\\\"\\r\\n                        matInput placeholder=\\\"Time to stay on each scanned item (in milliseconds)\\\">\\r\\n              </mat-form-field>\\r\\n            </mat-card>\\r\\n          </div>\\r\\n        </mat-tab>\\r\\n        <mat-tab ngModelGroup=\\\"appearance\\\" #appearanceCtrl=\\\"ngModelGroup\\\">\\r\\n          <ng-template mat-tab-label>\\r\\n            <mat-icon *ngIf=\\\"appearanceCtrl.invalid\\\" class=\\\"invalidTab\\\">error</mat-icon>\\r\\n            <span [class.invalidTab]=\\\"appearanceCtrl.invalid\\\" name=\\\"appearance\\\">Appearance</span>\\r\\n          </ng-template>\\r\\n          <div class=\\\"formContainer\\\">\\r\\n            <mat-card>\\r\\n              <div>\\r\\n                <mat-slider min=\\\"1\\\" max=\\\"10\\\" step=\\\"1\\\" color=\\\"Primary\\\"\\r\\n                  [(ngModel)]=\\\"appearanceConfig.borderThickness\\\" name=\\\"borderThickness\\\" thumbLabel=\\\"true\\\"\\r\\n                  (input)=\\\"borderThicknessChange($event)\\\"\\r\\n                ></mat-slider>\\r\\n                <div class=\\\"borderExample\\\" [style.border-width]=\\\"appearanceConfig.borderThickness + 'px'\\\">Border Thickness</div>\\r\\n              </div>\\r\\n            </mat-card>\\r\\n          </div>\\r\\n        </mat-tab>\\r\\n      </mat-tab-group>\\r\\n    </form>\\r\\n  </mat-card>\\r\\n  <p>Version: {{getVersion()}}</p>\\r\\n</app-obfpage>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { ConfigService, ButtonDisplayConfig, ScanningConfig, AppearanceConfig, ButtonBehaviourConfig,\r\n  InteractionEventType, VoiceConfig} from '../config.service';\r\nimport { MatSnackBar } from '@angular/material';\r\nimport { VERSION } from '../../environments/version';\r\nimport { BoardCacheService } from '../board-cache.service';\r\n\r\n@Component({\r\n  selector: 'app-config-page',\r\n  templateUrl: './config-page.component.html',\r\n  styleUrls: ['./config-page.component.css']\r\n})\r\nexport class ConfigPageComponent implements OnInit {\r\n\r\n  PAGESET_PARAM = 'pagesetURL';\r\n\r\n  boardURL: string;\r\n  showIconsInSpeechbar: boolean;\r\n  speakOnSpeechbarClick: boolean;\r\n  displayedButtons: ButtonDisplayConfig;\r\n  scanningConfig: ScanningConfig;\r\n  appearanceConfig: AppearanceConfig;\r\n  buttonBehaviourConfig: ButtonBehaviourConfig;\r\n  voiceConfig: VoiceConfig;\r\n  interactionEventType = InteractionEventType;\r\n\r\n  constructor(\r\n    private configService: ConfigService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private snackBar: MatSnackBar,\r\n    private boardCache: BoardCacheService) { }\r\n\r\n  ngOnInit() {\r\n    this.boardURL = this.configService.boardURL;\r\n    this.displayedButtons = this.copyConfig(this.configService.displayedButtons);\r\n    this.showIconsInSpeechbar = this.configService.showIconsInSpeechbar;\r\n    this.speakOnSpeechbarClick = this.configService.speakOnSpeechbarClick;\r\n    this.scanningConfig = this.copyConfig(this.configService.scanningConfig);\r\n    this.appearanceConfig = this.copyConfig(this.configService.appearanceConfig);\r\n    this.buttonBehaviourConfig = this.copyConfig(this.configService.buttonBehaviourConfig);\r\n    this.voiceConfig = this.copyConfig(this.configService.voiceConfig);\r\n\r\n    const configURLParam = this.route.snapshot.queryParamMap.get(this.PAGESET_PARAM);\r\n    if (configURLParam) {\r\n      this.boardURL = configURLParam;\r\n      this.save();\r\n    }\r\n  }\r\n\r\n  private copyConfig(config: any): any {\r\n    return JSON.parse(JSON.stringify(config));\r\n  }\r\n\r\n  save() {\r\n    this.configService.boardURL = this.boardURL;\r\n    this.configService.displayedButtons = this.displayedButtons;\r\n    this.configService.showIconsInSpeechbar = this.showIconsInSpeechbar;\r\n    this.configService.speakOnSpeechbarClick = this.speakOnSpeechbarClick;\r\n    this.configService.scanningConfig = this.scanningConfig;\r\n    this.configService.appearanceConfig = this.appearanceConfig;\r\n    this.configService.buttonBehaviourConfig = this.buttonBehaviourConfig;\r\n    this.configService.voiceConfig = this.voiceConfig;\r\n    // TODO: some kind of validation\r\n\r\n    // clear local cache of page to force a refresh\r\n    this.boardCache.clear().subscribe(\r\n      () => {\r\n        this.router.navigate(['/main']);\r\n      },\r\n      (error) => {\r\n        // not much we can do really\r\n        console.error('Error clearing cache', error);\r\n        this.router.navigate(['/main']);\r\n      }\r\n    );\r\n  }\r\n\r\n  copyToClipboard() {\r\n    const selBox = document.createElement('textarea');\r\n    selBox.style.position = 'fixed';\r\n    selBox.style.left = '0';\r\n    selBox.style.top = '0';\r\n    selBox.style.opacity = '0';\r\n    selBox.value = `${document.location.href}?${this.PAGESET_PARAM}=${encodeURI(this.boardURL)}`;\r\n    document.body.appendChild(selBox);\r\n    selBox.focus();\r\n    selBox.select();\r\n    document.execCommand('copy');\r\n    document.body.removeChild(selBox);\r\n    this.snackBar.open('Configuration link copied to clipboard', '', { duration: 1000 });\r\n  }\r\n\r\n  getVersion() {\r\n    return VERSION.tag;\r\n  }\r\n\r\n  borderThicknessChange(event: any) {\r\n    this.appearanceConfig.borderThickness = event.value;\r\n  }\r\n\r\n  availableVoices() {\r\n    return (<any>window).speechSynthesis.getVoices();\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { LocalStorage } from 'ngx-store';\r\nimport { Subject } from 'rxjs';\r\n\r\nexport interface ButtonDisplayConfig {\r\n  showSpeakButton: boolean;\r\n  showBackspaceButton: boolean;\r\n  showClearButton: boolean;\r\n  showHomeButton: boolean;\r\n}\r\n\r\nexport interface ScanningConfig {\r\n  enabled: boolean;\r\n  time: number;\r\n}\r\n\r\nexport interface AppearanceConfig {\r\n  borderThickness: number;\r\n}\r\n\r\nexport enum InteractionEventType {\r\n  click = 'click',\r\n  mouseup = 'mouseup',\r\n  mousedown = 'mousedown'\r\n}\r\n\r\nexport interface ButtonBehaviourConfig {\r\n  speakOnTrigger: boolean;\r\n  triggerEvent: InteractionEventType;\r\n}\r\n\r\nexport interface VoiceConfig {\r\n  userVoice: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ConfigService {\r\n\r\n  @LocalStorage() _boardURL = 'https://dl.dropboxusercontent.com/s/oiwfo47fprv3jl4/ck20.obz?dl=1';\r\n  @LocalStorage() _showIconsInSpeechbar = true;\r\n  @LocalStorage() _speakOnSpeechbarClick = true;\r\n  @LocalStorage() _displayedButtons: ButtonDisplayConfig = {\r\n    showSpeakButton: true,\r\n    showBackspaceButton: true,\r\n    showClearButton: true,\r\n    showHomeButton: false\r\n  };\r\n  @LocalStorage() _scanningConfig: ScanningConfig = {\r\n    enabled: false,\r\n    time: 1000,\r\n  };\r\n  @LocalStorage() _appearanceConfig: AppearanceConfig = {\r\n    borderThickness: 2\r\n  };\r\n  @LocalStorage() _buttonBehaviourConfig: ButtonBehaviourConfig = {\r\n    speakOnTrigger: false,\r\n    triggerEvent: InteractionEventType.click\r\n  };\r\n  @LocalStorage() _voiceConfig: VoiceConfig = {\r\n    userVoice: undefined\r\n  };\r\n\r\n  private voiceConfigSource = new Subject<VoiceConfig>();\r\n  voiceConfig$ = this.voiceConfigSource.asObservable();\r\n\r\n  constructor() { }\r\n\r\n  get boardURL(): string {\r\n    return this._boardURL;\r\n  }\r\n\r\n  get displayedButtons(): ButtonDisplayConfig {\r\n    return this._displayedButtons;\r\n  }\r\n\r\n  get showIconsInSpeechbar(): boolean {\r\n    return this._showIconsInSpeechbar;\r\n  }\r\n\r\n  get speakOnSpeechbarClick(): boolean {\r\n    return this._speakOnSpeechbarClick;\r\n  }\r\n\r\n  get scanningConfig(): ScanningConfig {\r\n    return this._scanningConfig;\r\n  }\r\n\r\n  get appearanceConfig(): AppearanceConfig {\r\n    return this._appearanceConfig;\r\n  }\r\n\r\n  get buttonBehaviourConfig(): ButtonBehaviourConfig {\r\n    return this._buttonBehaviourConfig;\r\n  }\r\n\r\n  get voiceConfig(): VoiceConfig {\r\n    return this._voiceConfig;\r\n  }\r\n\r\n  set boardURL(boardURL: string) {\r\n    this._boardURL = boardURL;\r\n  }\r\n\r\n  set displayedButtons(displayedButtons: ButtonDisplayConfig) {\r\n    this._displayedButtons = displayedButtons;\r\n  }\r\n\r\n  set showIconsInSpeechbar(showIconsInSpeechbar: boolean) {\r\n    this._showIconsInSpeechbar = showIconsInSpeechbar;\r\n  }\r\n  set speakOnSpeechbarClick(speakOnSpeechbarClick: boolean) {\r\n    this._speakOnSpeechbarClick = speakOnSpeechbarClick;\r\n  }\r\n\r\n  set scanningConfig(scanningConfig: ScanningConfig) {\r\n    this._scanningConfig = scanningConfig;\r\n  }\r\n\r\n  set appearanceConfig(appearanceConfig: AppearanceConfig) {\r\n    this._appearanceConfig = appearanceConfig;\r\n  }\r\n\r\n  set buttonBehaviourConfig(buttonBehaviourConfig: ButtonBehaviourConfig) {\r\n    this._buttonBehaviourConfig = buttonBehaviourConfig;\r\n  }\r\n\r\n  set voiceConfig(voiceConfig: VoiceConfig) {\r\n    this._voiceConfig = voiceConfig;\r\n    this.voiceConfigSource.next(this._voiceConfig);\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { registerDecorator, ValidationOptions, ValidationArguments } from 'class-validator';\r\n\r\nexport function OneOf(validationProperties: string[], validationOptions?: ValidationOptions) {\r\n  return function (object: Object, propertyName: string) {\r\n    registerDecorator({\r\n      name: 'OneOf',\r\n      target: object.constructor,\r\n      propertyName: propertyName,\r\n      constraints: [validationProperties],\r\n      options: validationOptions,\r\n      validator: {\r\n        validate(value: any, args: ValidationArguments) {\r\n          const theObject = <any>args.object;\r\n          function isValid(element: string): boolean {\r\n            const val = theObject[element];\r\n            return val !== undefined && val !== null;\r\n          }\r\n          return (<Array<string>>args.constraints[0]).some(isValid);\r\n        }\r\n      }\r\n    });\r\n  };\r\n}\r\n\r\nexport function Check2DArray(widthProperty: string, heightProperty: string, validationOptions?: ValidationOptions) {\r\n  return function (object: Object, propertyName: string) {\r\n    registerDecorator({\r\n      name: 'Check2DArray',\r\n      target: object.constructor,\r\n      propertyName: propertyName,\r\n      constraints: [widthProperty, heightProperty],\r\n      options: validationOptions,\r\n      validator: {\r\n        validate(value: any, args: ValidationArguments) {\r\n\r\n          const widthName = args.constraints[0];\r\n          const heightName = args.constraints[1];\r\n\r\n          const widthValue = (args.object as any)[widthName];\r\n          const heightValue = (args.object as any)[heightName];\r\n\r\n          if (value.length === heightValue) {\r\n            let count = 0;\r\n            for (const row of value) {\r\n              count++;\r\n              if (row.length !== widthValue) {\r\n                this.message = `Row ${count} is of width ${row.length}, but it should be ${widthValue}`;\r\n                return false;\r\n              }\r\n            }\r\n            return true;\r\n          } else {\r\n            this.message = `Grid has ${value.length} rows but should have ${heightValue}`;\r\n            return false;\r\n          }\r\n        },\r\n\r\n        defaultMessage(args: ValidationArguments) {\r\n          return this.message;\r\n        }\r\n      }\r\n    });\r\n  };\r\n}\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\r\\n.errorCard {\\r\\n  margin: 100px;\\r\\n}\\r\\n.label {\\r\\n  font-weight: bold;\\r\\n  font-size: larger;\\r\\n  vertical-align: top;\\r\\n}\\r\\n.message {\\r\\n  background-color: #eee;\\r\\n  border: lightgrey solid 1px;\\r\\n  padding: 1em;\\r\\n  margin: 0px;\\r\\n  white-space: pre-wrap;\\r\\n}\\r\\ntd {\\r\\n  padding: 1em;\\r\\n}\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<app-obfpage>\\r\\n  <mat-card class=\\\"errorCard\\\">\\r\\n    <h2>\\r\\n      Oh no! Something went wrong!\\r\\n    </h2>\\r\\n    <table *ngIf=\\\"error\\\">\\r\\n      <tr>\\r\\n        <td class=\\\"label\\\">Location</td>\\r\\n        <td><pre class=\\\"message\\\">{{error.location}}</pre></td>\\r\\n      </tr>\\r\\n      <tr>\\r\\n        <td class=\\\"label\\\">Message</td>\\r\\n        <td><pre class=\\\"message\\\">{{error.message}}</pre></td>\\r\\n      </tr>\\r\\n      <tr>\\r\\n        <td class=\\\"label\\\">Cause</td>\\r\\n        <td><pre class=\\\"message\\\">{{error.causeChain}}</pre></td>\\r\\n      </tr>\\r\\n    </table>\\r\\n    <button mat-raised-button (click)=\\\"goToConfig()\\\">Go to config page</button>\\r\\n    <p>If you need help resolving this issue or believe it may be an issue on our side, please don't hesitate to contact us.</p>\\r\\n    <a *ngIf=\\\"error\\\" [href]=\\\"errorHRef\\\" target=\\\"_top\\\" mat-raised-button>Send error report</a>\\r\\n  </mat-card>\\r\\n</app-obfpage>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { ErrorService, ErrorDetails } from '../error.service';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-error-page',\r\n  templateUrl: './error-page.component.html',\r\n  styleUrls: ['./error-page.component.css']\r\n})\r\nexport class ErrorPageComponent implements OnInit {\r\n\r\n  error: ErrorDetails;\r\n\r\n  constructor(private errorService: ErrorService, private router: Router) { }\r\n\r\n  ngOnInit() {\r\n    this.error = this.errorService.lastError;\r\n  }\r\n\r\n  goToConfig() {\r\n    this.router.navigate(['/config']);\r\n  }\r\n\r\n  get errorHRef(): string {\r\n    let href = 'mailto:support@equalitytime.co.uk';\r\n    href += '?subject=' + encodeURI(this.error.message);\r\n    href += '&body=' + encodeURI(this.errorAsString());\r\n    return href;\r\n  }\r\n\r\n  private errorAsString(): string {\r\n    let errorString = 'Location: ' + this.error.location;\r\n    errorString += '\\nMessage: ' + this.error.message;\r\n    errorString += '\\nCause: ' + this.error.causeChain;\r\n    return errorString;\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\n\r\nexport class ErrorDetails {\r\n  location: string;\r\n  message: string;\r\n  causeChain: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ErrorService {\r\n\r\n  private _lastError: ErrorDetails;\r\n\r\n  constructor() { }\r\n\r\n  get lastError(): ErrorDetails {\r\n    return this._lastError;\r\n  }\r\n\r\n  set lastError(error: ErrorDetails) {\r\n    this._lastError = error;\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nexport class OpenVoiceFactoryError extends Error {\r\n\r\n  public    cause:     Error;\r\n  protected clz:       string;\r\n  public    errorCode: number;\r\n\r\n  constructor(errorCode: number, message?: string, cause?: Error) {\r\n    super(message);\r\n    this.cause = cause;\r\n    this.clz = 'OpenVoiceFactoryError';\r\n    this.errorCode = errorCode;\r\n  }\r\n}\r\n\r\nexport class FatalOpenVoiceFactoryError extends OpenVoiceFactoryError {\r\n\r\n  constructor(errorCode: number, message?: string, cause?: Error) {\r\n    super(errorCode, message, cause);\r\n    this.clz = 'FatalOpenVoiceFactoryError';\r\n  }\r\n}\r\n\r\nexport class ErrorCodes {\r\n  static MISSING_MANIFEST    = 0;\r\n  static OBF_LOAD_ERROR      = 1;\r\n  static OBZ_PARSE_ERROR     = 2;\r\n  static OBZ_DOWNLOAD_ERROR  = 3;\r\n  static MANIFEST_LOAD_ERROR = 4;\r\n  static ZIP_PARSE_ERROR     = 5;\r\n  static IMAGE_LOAD_ERROR    = 6;\r\n  static SOUND_LOAD_ERROR    = 7;\r\n  static BOARD_PARSE_ERROR   = 8;\r\n  static MANIFEST_JSON_ERROR = 9;\r\n  static BOARD_NOT_THERE     = 10;\r\n  static SOUND_NOT_THERE     = 11;\r\n  static IMAGE_NOT_THERE     = 12;\r\n  static OBF_VALIDATION      = 13;\r\n  static INVALID_ROOT        = 14;\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable, ErrorHandler, Injector, NgZone } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { ErrorDetails, ErrorService } from './error.service';\r\n\r\n@Injectable()\r\nexport class GlobalErrorHandlerService implements ErrorHandler {\r\n\r\n  constructor(private injector: Injector) { }\r\n\r\n  handleError(error: any) {\r\n\r\n    const zone   = this.injector.get(NgZone);\r\n    const router = this.injector.get(Router);\r\n    const errSer = this.injector.get(ErrorService);\r\n\r\n    console.error(error);\r\n    // TODO: buffer logs\r\n    console.log(`Error on page ${router.url}: ${error.message}`);\r\n\r\n    // Pull reason out of a promise error if it is one\r\n    if (error.rejection) {\r\n      error = error.rejection;\r\n    }\r\n\r\n    const errorDetails = new ErrorDetails();\r\n    errorDetails.message = error.message;\r\n    errorDetails.location = router.url;\r\n\r\n    let cause = error.cause;\r\n    while (cause) {\r\n      errorDetails.causeChain = errorDetails.causeChain ? errorDetails.causeChain + '\\n' + cause.toString() : cause.toString();\r\n      console.log(`Caused by: ${cause.toString()}`);\r\n      cause = cause.cause;\r\n      // TODO: decent stack trace?\r\n    }\r\n\r\n    errSer.lastError = errorDetails;\r\n\r\n    // if we've got a fatal error then go to the error page\r\n    if ('FatalOpenVoiceFactoryError' === error.clz) {\r\n      zone.run(() => {\r\n        router.navigate(['/error']);\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { Directive, HostListener, Input } from '@angular/core';\r\nimport { ConfigService, InteractionEventType } from './config.service';\r\n\r\n@Directive({\r\n  selector: '[appInteractionEventHandler]'\r\n})\r\nexport class InteractionEventHandlerDirective {\r\n\r\n  @Input('appInteractionEventHandler')\r\n  private appInteractionEventHandler: () => void;\r\n\r\n  constructor(private config: ConfigService) { }\r\n\r\n  @HostListener('mouseup') onRelease() {\r\n    this.handleEvent(InteractionEventType.mouseup);\r\n  }\r\n\r\n  @HostListener('mousedown') onPress() {\r\n    this.handleEvent(InteractionEventType.mousedown);\r\n  }\r\n\r\n  @HostListener('click') onClick() {\r\n    this.handleEvent(InteractionEventType.click);\r\n  }\r\n\r\n  handleEvent(eventType: InteractionEventType) {\r\n    if (eventType === this.config.buttonBehaviourConfig.triggerEvent) {\r\n      this.appInteractionEventHandler();\r\n    }\r\n  }\r\n}\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\r\\n.speechbar {\\r\\n  height: 20vh;\\r\\n}\\r\\n.buttonPage {\\r\\n  height: 80vh;\\r\\n}\\r\\n.scanRegion {\\r\\n  position: relative;\\r\\n}\\r\\n.scanRegion:after {\\r\\n  content: \\\" \\\";\\r\\n  position: absolute;\\r\\n  z-index: 10;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n  bottom: 0;\\r\\n}\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<div class=\\\"scanRegion\\\" *ngIf=\\\"scanningEnabled(); else content;\\\" (click)=\\\"handleClick()\\\">\\r\\n    <ng-container *ngTemplateOutlet=\\\"content\\\"></ng-container>\\r\\n</div>\\r\\n\\r\\n\\r\\n<ng-template #content>\\r\\n  <div class=\\\"speechbar\\\"><app-speechbar></app-speechbar></div>\\r\\n  <div class=\\\"buttonPage\\\"><app-button-page></app-button-page></div>\\r\\n</ng-template>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { ScanningService } from '../scanning.service';\r\nimport { ConfigService } from '../config.service';\r\n\r\n@Component({\r\n  selector: 'app-main-page',\r\n  templateUrl: './main-page.component.html',\r\n  styleUrls: ['./main-page.component.css']\r\n})\r\nexport class MainPageComponent implements OnInit {\r\n\r\n  constructor(private scanningService: ScanningService, private configService: ConfigService) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  scanningEnabled(): boolean {\r\n    return this.configService.scanningConfig.enabled;\r\n  }\r\n\r\n  handleClick() {\r\n    this.scanningService.handleInteraction();\r\n  }\r\n\r\n}\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\r\\n.buttonDiv {\\r\\n  width: calc(100% - 2 * var(--borderWidth));\\r\\n  height: calc(100% - 2 * var(--borderWidth));\\r\\n  border: var(--borderWidth) solid;\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  word-break: break-word;\\r\\n}\\r\\n.buttonImageDiv {\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  min-height: 0;\\r\\n  display: flex;\\r\\n}\\r\\n.buttonImage {\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  -o-object-fit: contain;\\r\\n     object-fit: contain;\\r\\n  pointer-events: none;\\r\\n}\\r\\n.buttonLabel {\\r\\n  text-align: center;\\r\\n}\\r\\n.ripple {\\r\\n  position: relative;\\r\\n  overflow: hidden;\\r\\n}\\r\\n.ripple:hover {\\r\\n  -webkit-transform: scale(0.98, 0.98);\\r\\n          transform: scale(0.98, 0.98);\\r\\n}\\r\\n.pageTurn:before {\\r\\n  content: '';\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  --turn-size: 16px;\\r\\n  left: calc(100% - var(--turn-size));\\r\\n  border-width: 0 var(--turn-size) var(--turn-size) 0;\\r\\n  border-style: solid;\\r\\n  border-color: #fff #fff #658E15 #658E15;\\r\\n  background: #658E15;\\r\\n  box-shadow: 0 1px 1px rgba(0,0,0,0.3), -1px 1px 1px rgba(0,0,0,0.2);\\r\\n  display: block;\\r\\n  width: 0;\\r\\n}\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<div class=\\\"buttonDiv\\\" [appInteractionEventHandler]=\\\"handleClick.bind(this)\\\"\\r\\n     [class.pageTurn]=\\\"clickHandler && butt.loadBoardAction\\\"\\r\\n     [class.ripple]=\\\"clickHandler\\\"\\r\\n     [style.background-color]=\\\"butt.backgroundColor\\\"\\r\\n     [style.border-color]=\\\"butt.borderColor\\\"\\r\\n     mat-ripple [matRippleDisabled]=\\\"!clickHandler\\\">\\r\\n  <div class=\\\"buttonImageDiv\\\" *ngIf=\\\"butt.getImage() as image\\\">\\r\\n    <img class=\\\"buttonImage\\\" [src]=\\\"getDataURL()\\\"/>\\r\\n  </div>\\r\\n  <div class=\\\"buttonLabel\\\">\\r\\n    {{butt.label}}\\r\\n  </div>\\r\\n</div>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit, Input, OnDestroy, HostBinding } from '@angular/core';\r\nimport { Button } from '../obfboard';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { AppearanceConfig, ConfigService } from '../config.service';\r\n\r\n@Component({\r\n  selector: 'app-obf-button',\r\n  templateUrl: './obf-button.component.html',\r\n  styleUrls: ['./obf-button.component.css']\r\n})\r\nexport class ObfButtonComponent implements OnInit, OnDestroy {\r\n\r\n  @Input()\r\n  butt: Button;\r\n\r\n  @Input()\r\n  clickHandler: (Button) => void;\r\n\r\n  appearanceConfig: AppearanceConfig;\r\n\r\n  private url: string;\r\n\r\n  constructor(private domSanit: DomSanitizer, private config: ConfigService) {}\r\n\r\n  @HostBinding('attr.style')\r\n  public get valueAsStyle(): any {\r\n    return this.domSanit.bypassSecurityTrustStyle(`--borderWidth: ${this.appearanceConfig.borderThickness + 'px'}`);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.appearanceConfig = this.config.appearanceConfig;\r\n  }\r\n\r\n  getDataURL() {\r\n    this.url = URL.createObjectURL(this.butt.getImage().getDataBlob());\r\n    return this.domSanit.bypassSecurityTrustUrl(this.url);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.unload();\r\n  }\r\n\r\n  private unload() {\r\n    if (this.url) {\r\n      URL.revokeObjectURL(this.url);\r\n      this.url = undefined;\r\n    }\r\n  }\r\n\r\n  handleClick() {\r\n    if (this.clickHandler) {\r\n      this.clickHandler(this.butt);\r\n    }\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport {\r\n  IsString,\r\n  IsNotEmpty,\r\n  IsOptional,\r\n  IsDefined,\r\n  IsInt,\r\n  IsUrl,\r\n  ValidateNested,\r\n  validateSync,\r\n  ValidationError,\r\n} from 'class-validator';\r\nimport { ImageResolver } from './image-resolver';\r\nimport { SoundResolver } from './sound-resolver';\r\nimport { FatalOpenVoiceFactoryError, ErrorCodes } from './errors';\r\nimport { Check2DArray, OneOf } from './custom-validation';\r\n\r\nfunction stringify(value: any): string {\r\n  return value || value === 0 ? String(value) : undefined;\r\n}\r\n\r\nexport class Grid {\r\n\r\n  @IsDefined()\r\n  @IsInt()\r\n  rows: number;\r\n\r\n  @IsDefined()\r\n  @IsInt()\r\n  columns: number;\r\n\r\n  @Check2DArray('columns', 'rows')\r\n  order: string[][];\r\n\r\n  deserialize(input: any): Grid {\r\n    this.rows = input.rows;\r\n    this.columns = input.columns;\r\n    this.order = input.order.map(row => row.map(cell => stringify(cell)));\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class LoadBoardAction {\r\n\r\n  @OneOf(['url', 'dataUrl', 'path'], { message: 'Load board should have one of dataUrl, url or path'})\r\n  id: string;\r\n\r\n  name: string;\r\n\r\n  @IsOptional()\r\n  @IsUrl()\r\n  url: string;\r\n\r\n  @IsOptional()\r\n  @IsUrl()\r\n  dataUrl: string;\r\n\r\n  path: string;\r\n\r\n  deserialize(input: any): LoadBoardAction {\r\n    this.id = input.id;\r\n    this.name = input.name;\r\n    this.url = input.url;\r\n    this.dataUrl = input.dataUrl || input.data_url;\r\n    this.path = input.path;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class Button {\r\n\r\n  @IsNotEmpty({ message: 'Button id must be specified'})\r\n  @IsString({ message: 'Button id must be a string'})\r\n  id: string;\r\n\r\n  @IsNotEmpty()\r\n  @IsString()\r\n  label: string;\r\n\r\n  @IsOptional()\r\n  @IsString()\r\n  vocalization: string;\r\n\r\n  @IsOptional()\r\n  @IsString()\r\n  imageId: string;\r\n\r\n  @IsOptional()\r\n  @IsString()\r\n  soundId: string;\r\n\r\n  backgroundColor: string;\r\n  borderColor: string;\r\n  actions: string[];\r\n  loadBoardAction: LoadBoardAction;\r\n\r\n  @IsDefined()\r\n  parent: OBFBoard;\r\n\r\n  deserialize(input: any, parent: OBFBoard): Button {\r\n    this.id = stringify(input.id);\r\n    this.label = input.label;\r\n    this.vocalization = input.vocalization;\r\n    this.imageId = stringify(input.imageId) || stringify(input.image_id);\r\n    this.soundId = stringify(input.soundId) || stringify(input.sound_id);\r\n    this.backgroundColor = input.backgroundColor || input.background_color;\r\n    this.borderColor = input.borderColor || input.border_color;\r\n    this.parent = parent;\r\n\r\n    if (input.actions && input.actions.length > 0) {\r\n      this.actions = input.actions;\r\n    } else {\r\n      this.actions = (input.action !== undefined && input.action !== '') ? [input.action] : [];\r\n    }\r\n\r\n    if (input.loadBoardAction || input.load_board) {\r\n      this.loadBoardAction = new LoadBoardAction().deserialize(input.loadBoardAction || input.load_board);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  getVocalization(): string {\r\n    return this.vocalization || this.label;\r\n  }\r\n\r\n  getImage(): Image {\r\n    return this.imageId && this.parent.getImage(this.imageId);\r\n  }\r\n}\r\n\r\nexport class Image {\r\n\r\n  @OneOf(['url', 'data', 'path', 'symbol'], { message: 'Image with id \"$value\" must specifiy data, a url or a path' })\r\n  @IsString({ message: 'Image id must be a string' })\r\n  @IsNotEmpty({ message: 'Image id must be specified'})\r\n  id: string;\r\n\r\n  @IsOptional()\r\n  @IsInt()\r\n  width: number;\r\n\r\n  @IsOptional()\r\n  @IsInt()\r\n  height: number;\r\n\r\n  @IsOptional()\r\n  data: string;\r\n\r\n  @IsOptional()\r\n  @IsUrl()\r\n  url: string;\r\n\r\n  @IsOptional()\r\n  symbol: string;\r\n\r\n  @IsOptional()\r\n  @IsString()\r\n  path: string;\r\n\r\n  contentType: string;\r\n\r\n  @IsDefined()\r\n  parent: OBFBoard;\r\n\r\n  @IsOptional()\r\n  @IsString()\r\n  svgData: string;\r\n\r\n  deserialize(input: any, parent: OBFBoard): Image {\r\n    this.id = stringify(input.id);\r\n    this.width = input.width;\r\n    this.height = input.height;\r\n    this.data = input.data;\r\n    this.url = input.url;\r\n    this.path = input.path;\r\n    this.contentType = input.contentType || input.content_type;\r\n    this.parent = parent;\r\n    this.symbol = JSON.stringify(input.symbol);\r\n\r\n    return this;\r\n  }\r\n\r\n  getDataBlob(): Blob {\r\n    return this.parent.imageResolver.getImageData(this.path);\r\n  }\r\n}\r\n\r\nexport class Sound {\r\n\r\n  @IsNotEmpty({ message: 'Sound id must be specified'})\r\n  @IsString({ message: 'Sound id must be a string'})\r\n  @OneOf(['url', 'data', 'path'], { message: 'Sound with id \"$value\" must specifiy data, a url or a path' })\r\n  id: string;\r\n\r\n  @IsOptional()\r\n  data: string;\r\n\r\n  @IsOptional()\r\n  @IsUrl()\r\n  url: string;\r\n\r\n  @IsOptional()\r\n  path: string;\r\n\r\n  contentType: string;\r\n\r\n  duration: number;\r\n\r\n  @IsDefined()\r\n  parent: OBFBoard;\r\n\r\n  deserialize(input: any, parent: OBFBoard): Sound {\r\n    this.id = stringify(input.id);\r\n    this.data = input.data;\r\n    this.url = input.url;\r\n    this.path = input.path;\r\n    this.contentType = input.contentType || input.content_type;\r\n    this.duration = input.duration;\r\n    this.parent = parent;\r\n\r\n    return this;\r\n  }\r\n\r\n  getSource(): string {\r\n    if (this.path && this.parent.soundResolver) {\r\n      const soundData = this.parent.soundResolver.getSoundData(this.path);\r\n      return `data:${this.contentType};base64,${soundData}`;\r\n    }\r\n    return this.data || this.url;\r\n  }\r\n}\r\n\r\nexport class OBFBoard {\r\n\r\n  format: string;\r\n\r\n  @IsNotEmpty({ message: 'Board id must be specified'})\r\n  @IsString({ message: 'Board id must be a string'})\r\n  id: string;\r\n\r\n  locale: string;\r\n\r\n  name: string;\r\n\r\n  @IsOptional()\r\n  @IsString()\r\n  descriptionHtml: string;\r\n\r\n  @ValidateNested()\r\n  @IsDefined()\r\n  grid: Grid;\r\n\r\n  @ValidateNested({\r\n    each: true\r\n  })\r\n  @IsDefined()\r\n  buttons: Button[];\r\n\r\n  @ValidateNested({\r\n    each: true\r\n  })\r\n  images: Image[];\r\n\r\n  @ValidateNested({\r\n    each: true\r\n  })\r\n  sounds: Sound[];\r\n\r\n  imageResolver: ImageResolver;\r\n\r\n  soundResolver: SoundResolver;\r\n\r\n  deserialize(input: any): OBFBoard {\r\n    this.format = input.format;\r\n    this.id = stringify(input.id);\r\n    this.locale = input.locale;\r\n    this.name = input.name;\r\n    this.descriptionHtml = input.descriptionHtml || input.description_html;\r\n    this.grid = new Grid().deserialize(input.grid);\r\n    this.buttons = input.buttons.map(button => new Button().deserialize(button, this));\r\n    this.images = input.images.map(image => new Image().deserialize(image, this));\r\n    this.sounds = input.sounds.map(sound => new Sound().deserialize(sound, this));\r\n\r\n    const errors = validateSync(this);\r\n    if (errors && errors.length > 0) {\r\n      const all_errors: string[] = [];\r\n      errors.forEach(err => all_errors.push(...this.messagesFromError(err)));\r\n      console.log(all_errors.join('\\n'));\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.OBF_VALIDATION, all_errors.join('\\n'));\r\n    }\r\n\r\n    // filter out images we can't display AFTER collecting error messages\r\n    this.images = this.images.filter(image => image.data || image.path || image.url);\r\n\r\n    return this;\r\n  }\r\n\r\n  private messagesFromError(error: ValidationError): string[] {\r\n    const ret: string[] = [];\r\n    console.log(error);\r\n    if (error.constraints) {\r\n      ret.push(...Object.values(error.constraints));\r\n    }\r\n    if (error.children) {\r\n      error.children.forEach(err => ret.push(...this.messagesFromError(err)));\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  setImageResolver(imageResolver: ImageResolver) {\r\n    this.imageResolver = imageResolver;\r\n  }\r\n\r\n  setSoundResolver(soundResolver: SoundResolver) {\r\n    this.soundResolver = soundResolver;\r\n  }\r\n\r\n  getButton(id: string): Button {\r\n    return id === null ? null : this.buttons.find(button => button.id === id);\r\n  }\r\n\r\n  getImage(id: string): Image {\r\n    return id === null ? null : this.images.find(image => image.id === id);\r\n  }\r\n\r\n  getSound(id: string): Sound {\r\n    return id === null ? null : this.sounds.find(sound => sound.id === id);\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-obfpage',\r\n  template: `<div class=\"obfpage\"><div class=\"inner\"><ng-content></ng-content></div></div>`,\r\n  styles: [`\r\n    .obfpage {\r\n      width: 100%;\r\n      height: 100%;\r\n      background-color: lightsteelblue;\r\n      position: absolute;\r\n    }\r\n    .inner {\r\n      margin: 20px;\r\n    }\r\n  `]\r\n})\r\nexport class OBFPageComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\r\nimport { Observable, throwError, from, of } from 'rxjs';\r\nimport { flatMap, catchError, first } from 'rxjs/operators';\r\nimport { ConfigService } from './config.service';\r\nimport { UrlUtils } from './url-utils';\r\nimport { OBZBoardSet } from './obzboard-set';\r\nimport { OBFBoard } from './obfboard';\r\n\r\nimport * as JSZip from 'jszip';\r\nimport { FatalOpenVoiceFactoryError, ErrorCodes } from './errors';\r\nimport { BoardCacheService } from './board-cache.service';\r\nimport { ProgressService } from './progress.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ObzService {\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private config: ConfigService,\r\n    private boardCache: BoardCacheService,\r\n    private progress: ProgressService\r\n  ) { }\r\n\r\n  getBoardSet(): Observable<OBZBoardSet> {\r\n    return this.loadBoardSet(this.config.boardURL);\r\n  }\r\n\r\n  public loadBoardSet(boardURL: string): Observable<OBZBoardSet> {\r\n    return this.boardCache.retrieve().pipe(catchError(err => this.loadFromNetwork(boardURL)));\r\n  }\r\n\r\n  private loadFromNetwork(boardURL: string): Observable<OBZBoardSet> {\r\n\r\n    this.progress.progress(ProgressService.message('Downloading'));\r\n    this.log(`Loading ${boardURL} from internet`);\r\n\r\n    const urlSlug = new UrlUtils().getSlug(boardURL);\r\n    this.log(`Parsed url ${urlSlug}`);\r\n\r\n    // Decide if we're loading an obz or an obf\r\n    if (urlSlug.toLowerCase().endsWith('.obf')) {\r\n      return this.loadOBFFile(boardURL);\r\n    } else {\r\n      // assume obz by default. For now.\r\n      return this.loadOBZFile(boardURL);\r\n    }\r\n  }\r\n\r\n  private cacheBoardSet = (boardURL: string, boardSet: OBZBoardSet): Observable<OBZBoardSet> => {\r\n    this.progress.progress(ProgressService.message('Parsing'));\r\n    this.log(`Blobifying ${boardURL}`);\r\n    return boardSet.blobify(this.http, this.progress).pipe(\r\n      flatMap(blobified => {\r\n        this.progress.progress(ProgressService.message('Caching'));\r\n        this.log(`Caching ${boardURL}`);\r\n        return this.boardCache.save(blobified);\r\n      }),\r\n      first(),\r\n      catchError(error => {\r\n        console.error(`Cache of ${boardURL} failed`, error);\r\n        // may as well carry on though as we have loaded the board\r\n        return of(boardSet);\r\n      })\r\n    );\r\n  }\r\n\r\n  private loadOBFFile(boardURL: string): Observable<OBZBoardSet> {\r\n    return this.http.get<OBFBoard>(boardURL).pipe(\r\n      flatMap(page => {\r\n        const boardSet = new OBZBoardSet();\r\n        boardSet.rootBoardKey = 'root';\r\n        boardSet.setBoard('root', new OBFBoard().deserialize(page));\r\n        return this.cacheBoardSet(boardURL, boardSet);\r\n      }),\r\n      catchError(err => throwError(\r\n        new FatalOpenVoiceFactoryError(ErrorCodes.OBF_LOAD_ERROR, `Failed to load obf from ${boardURL}`, err)\r\n      )\r\n    ));\r\n  }\r\n\r\n  private getOBZFile(boardURL: string): Observable<Blob> {\r\n    return this.http.get(boardURL, { responseType: 'blob' }).pipe(\r\n      catchError((error: HttpErrorResponse) => throwError(\r\n        new FatalOpenVoiceFactoryError(ErrorCodes.OBZ_DOWNLOAD_ERROR, `Failed to download file ${boardURL}: ${error.message}`)\r\n      ))\r\n    );\r\n  }\r\n\r\n  private loadOBZFile(boardURL: string): Observable<OBZBoardSet> {\r\n\r\n    return this.getOBZFile(boardURL).pipe(\r\n      flatMap(blob => {\r\n        return this.parseOBZFile(blob).pipe(\r\n          catchError(error => throwError(\r\n            new FatalOpenVoiceFactoryError(ErrorCodes.OBZ_PARSE_ERROR, `Could not parse ${boardURL} as a zip file`, error)\r\n          ))\r\n        );\r\n      }),\r\n      flatMap(boardSet => this.cacheBoardSet(boardURL, boardSet))\r\n    );\r\n  }\r\n\r\n  parseOBZFile(blob: Blob): Observable<OBZBoardSet> {\r\n    const parseBoard = this.parseBoard;\r\n    const parseImage = this.parseImage;\r\n    const parseSound = this.parseSound;\r\n    const validate   = this.validate;\r\n    const zipper = new JSZip();\r\n\r\n    return from(zipper.loadAsync(blob).then(function(zip) {\r\n      const manifestFile = zip.file('manifest.json');\r\n      if (!manifestFile) {\r\n        throw new FatalOpenVoiceFactoryError(ErrorCodes.MISSING_MANIFEST, 'No manifest file!');\r\n      }\r\n      return manifestFile.async('text').then(function (manifest: string) {\r\n\r\n        let manifestJSON = null;\r\n        try {\r\n          manifestJSON = JSON.parse(manifest);\r\n        } catch (error) {\r\n          throw new FatalOpenVoiceFactoryError(ErrorCodes.MANIFEST_JSON_ERROR, 'manifest.json is not json', error);\r\n        }\r\n        const boardSet = new OBZBoardSet();\r\n        boardSet.rootBoardKey = manifestJSON.root;\r\n\r\n        let promises = [];\r\n        promises = promises.concat(Object.values(manifestJSON.paths.boards).map(board => parseBoard(zip, board.toString(), boardSet)));\r\n\r\n        if (manifestJSON.paths.images) {\r\n          promises = promises.concat(Object.values(manifestJSON.paths.images).map(image => parseImage(zip, image.toString(), boardSet)));\r\n        }\r\n\r\n        if (manifestJSON.paths.sounds) {\r\n          promises = promises.concat(Object.values(manifestJSON.paths.sounds).map(sound => parseSound(zip, sound.toString(), boardSet)));\r\n        }\r\n\r\n        return Promise.all(promises).then(() => validate(boardSet));\r\n      }, function (fail) {\r\n        // error loading manifest\r\n        throw new FatalOpenVoiceFactoryError(ErrorCodes.MANIFEST_LOAD_ERROR, 'Could not load manifest.json', fail);\r\n      });\r\n    }, function (fail) {\r\n      // error loading zip file\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.ZIP_PARSE_ERROR, 'Could not parse zip file', fail);\r\n    }));\r\n  }\r\n\r\n  private validate(boardSet: OBZBoardSet): OBZBoardSet {\r\n\r\n    // test that root board is in board set\r\n    const rootBoard = boardSet.getBoard(boardSet.rootBoardKey);\r\n    if (!rootBoard) {\r\n      throw new FatalOpenVoiceFactoryError(\r\n        ErrorCodes.INVALID_ROOT,\r\n        `OBZ specifies a root of '${boardSet.rootBoardKey}' but this path is not present`\r\n      );\r\n    }\r\n\r\n    // TODO: validate all paths and references in board set\r\n    return boardSet;\r\n  }\r\n\r\n  private parseImage = (zip, image: string, boardSet: OBZBoardSet): Promise<void> => {\r\n    const imageFile = zip.file(image);\r\n    if (!imageFile) {\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.IMAGE_NOT_THERE, `Image ${image} is not present in obz`);\r\n    }\r\n    const imagePromise = imageFile.async('blob').then(function (contents) {\r\n      boardSet.setImage(image, contents);\r\n    }).catch(error => {\r\n      // error loading image file\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.IMAGE_LOAD_ERROR, `Error loading image file ${image}`, error);\r\n    });\r\n\r\n    return imagePromise;\r\n  }\r\n\r\n  private parseSound = (zip, sound: string, boardSet: OBZBoardSet): Promise<void> => {\r\n    const soundFile = zip.file(sound);\r\n    if (!soundFile) {\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.SOUND_NOT_THERE, `Sound ${sound} is not present in obz`);\r\n    }\r\n    const soundPromise = soundFile.async('base64').then(function (contents) {\r\n      boardSet.setSound(sound, contents);\r\n    }).catch(error => {\r\n      // error loading sound file\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.SOUND_LOAD_ERROR, `Error loading sound file ${sound}`, error);\r\n    });\r\n\r\n    return soundPromise;\r\n  }\r\n\r\n  private parseBoard = (zip, board: string, boardSet: OBZBoardSet): Promise<void> => {\r\n    const boardFile = zip.file(board);\r\n    if (!boardFile) {\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.BOARD_NOT_THERE, `Board ${board} is not present in obz`);\r\n    }\r\n    const boardPromise = boardFile.async('text').then(function (contents) {\r\n      boardSet.setBoard(board, new OBFBoard().deserialize(JSON.parse(contents)));\r\n    }).catch(error => {\r\n      // error loading board\r\n      throw new FatalOpenVoiceFactoryError(ErrorCodes.BOARD_PARSE_ERROR, `Error parsing board ${board}`, error);\r\n    });\r\n\r\n    return boardPromise;\r\n  }\r\n\r\n  private log(message: string) {\r\n    console.log(`ObzService: ${message}`);\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { OBFBoard } from './obfboard';\r\nimport { ImageResolver } from './image-resolver';\r\nimport { SoundResolver } from './sound-resolver';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { tap, map } from 'rxjs/operators';\r\nimport { Observable, forkJoin, of } from 'rxjs';\r\nimport { ProgressService } from './progress.service';\r\n\r\nexport class OBZBoardSet implements ImageResolver, SoundResolver {\r\n\r\n  private boards: Map<string, OBFBoard> = new Map();\r\n  private images: Map<string, Blob> = new Map();\r\n  private sounds: Map<string, string> = new Map();\r\n\r\n  rootBoardKey: string;\r\n\r\n  public getBoard(boardKey: string): OBFBoard {\r\n    return this.boards.get(boardKey);\r\n  }\r\n\r\n  public setBoard(boardKey: string, board: OBFBoard) {\r\n    this.boards.set(boardKey, board);\r\n    board.setImageResolver(this);\r\n    board.setSoundResolver(this);\r\n  }\r\n\r\n  public setImage(imageKey: string, imageData: Blob) {\r\n    this.images.set(imageKey, imageData);\r\n  }\r\n\r\n  public setSound(soundKey: string, soundData: string) {\r\n    this.sounds.set(soundKey, soundData);\r\n  }\r\n\r\n  public getImageData(imagePath: string): Blob {\r\n    return this.images.get(imagePath);\r\n  }\r\n\r\n  public getSoundData(soundPath: string): string {\r\n    return this.sounds.get(soundPath);\r\n  }\r\n\r\n  public blobify(httpClient: HttpClient, progress: ProgressService): Observable<OBZBoardSet> {\r\n\r\n    // TODO: go through boards and load other boards from board actions (until there are no more new ones!)\r\n\r\n    // TODO: error handling might be nice...\r\n\r\n    // go through all url & data images & sounds and blobify into maps\r\n    progress.progress(ProgressService.message('Pre-caching images'));\r\n    return this.blobifyImages(httpClient).pipe(\r\n      map(imageResult => this)\r\n    );\r\n\r\n    // TODO: sounds\r\n  }\r\n\r\n  private blobifyImages(httpClient: HttpClient): Observable<boolean> {\r\n\r\n    const observables = [];\r\n\r\n    this.boards.forEach(board => {\r\n      board.images.forEach(image => {\r\n        // if image already has a path, then don't worry\r\n        if (!image.path) {\r\n          // try data first\r\n          if (image.data && image.contentType) {\r\n            const key = `data:${image.id}`;\r\n            // TODO: we could use the content type from here that we're stripping off\r\n            const data = image.data.substr(image.data.indexOf(',') + 1);\r\n            this.setImage(key, this.base64ToBlob(data, image.contentType));\r\n            // set path to key so render code will look up blob in images\r\n            image.path = key;\r\n            // remove data as we don't need to cache it too\r\n            image.data = null;\r\n          } else if (image.url) {\r\n            // load url into blob\r\n            console.log(`Loading image ${image.url}`);\r\n            observables.push(httpClient.get(image.url, { responseType: 'blob' }).pipe(\r\n              tap(blob => {\r\n                const key = `url:${image.id}`;\r\n                this.setImage(key, blob);\r\n                image.path = key;\r\n                image.url = null;\r\n              })\r\n            ));\r\n          }\r\n        }\r\n      });\r\n    });\r\n\r\n    return observables.length > 0 ? forkJoin(...observables) : of(true);\r\n  }\r\n\r\n  private base64ToBlob(data: string, type: string): Blob {\r\n    const byteArray = new Uint8Array(Array.from(atob(data)).map(char => char.charCodeAt(0)));\r\n    return new Blob([byteArray], { type: type });\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable, Observer } from 'rxjs';\r\n\r\nexport class ProgressObject {\r\n  message: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ProgressService {\r\n\r\n  private observer: Observer<ProgressObject>;\r\n\r\n  static message(msg: string): ProgressObject {\r\n    const ret = new ProgressObject();\r\n    ret.message = msg;\r\n    return ret;\r\n  }\r\n\r\n  constructor() {}\r\n\r\n  getProgress = (): Observable<ProgressObject> => {\r\n    return new Observable(this.addObserver);\r\n  }\r\n\r\n  private addObserver = (observer: Observer<ProgressObject>) => {\r\n    this.observer = observer;\r\n  }\r\n\r\n  progress = (progObj: ProgressObject) => {\r\n    if (this.observer) {\r\n      this.observer.next(progObj);\r\n    }\r\n  }\r\n}\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\r\\n.maxSpace {\\r\\n  width: 100%;\\r\\n  text-align: center;\\r\\n}\\r\\n.progressMessage {\\r\\n  font-size: small;\\r\\n}\\r\\n.spinner {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  width: 64px;\\r\\n  height: 64px;\\r\\n}\\r\\n.spinner div {\\r\\n  position: absolute;\\r\\n  top: 27px;\\r\\n  width: 11px;\\r\\n  height: 11px;\\r\\n  border-radius: 50%;\\r\\n  background: green;\\r\\n  -webkit-animation-timing-function: cubic-bezier(0, 1, 1, 0);\\r\\n          animation-timing-function: cubic-bezier(0, 1, 1, 0);\\r\\n}\\r\\n.spinner div:nth-child(1) {\\r\\n  left: 6px;\\r\\n  -webkit-animation: spinner1 0.6s infinite;\\r\\n          animation: spinner1 0.6s infinite;\\r\\n}\\r\\n.spinner div:nth-child(2) {\\r\\n  left: 6px;\\r\\n  -webkit-animation: spinner2 0.6s infinite;\\r\\n          animation: spinner2 0.6s infinite;\\r\\n}\\r\\n.spinner div:nth-child(3) {\\r\\n  left: 26px;\\r\\n  -webkit-animation: spinner2 0.6s infinite;\\r\\n          animation: spinner2 0.6s infinite;\\r\\n}\\r\\n.spinner div:nth-child(4) {\\r\\n  left: 45px;\\r\\n  -webkit-animation: spinner3 0.6s infinite;\\r\\n          animation: spinner3 0.6s infinite;\\r\\n}\\r\\n@-webkit-keyframes spinner1 {\\r\\n  0% {\\r\\n    -webkit-transform: scale(0);\\r\\n            transform: scale(0);\\r\\n  }\\r\\n  100% {\\r\\n    -webkit-transform: scale(1);\\r\\n            transform: scale(1);\\r\\n  }\\r\\n}\\r\\n@keyframes spinner1 {\\r\\n  0% {\\r\\n    -webkit-transform: scale(0);\\r\\n            transform: scale(0);\\r\\n  }\\r\\n  100% {\\r\\n    -webkit-transform: scale(1);\\r\\n            transform: scale(1);\\r\\n  }\\r\\n}\\r\\n@-webkit-keyframes spinner2 {\\r\\n  0% {\\r\\n    -webkit-transform: translate(0, 0);\\r\\n            transform: translate(0, 0);\\r\\n  }\\r\\n  100% {\\r\\n    -webkit-transform: translate(19px, 0);\\r\\n            transform: translate(19px, 0);\\r\\n  }\\r\\n}\\r\\n@keyframes spinner2 {\\r\\n  0% {\\r\\n    -webkit-transform: translate(0, 0);\\r\\n            transform: translate(0, 0);\\r\\n  }\\r\\n  100% {\\r\\n    -webkit-transform: translate(19px, 0);\\r\\n            transform: translate(19px, 0);\\r\\n  }\\r\\n}\\r\\n@-webkit-keyframes spinner3 {\\r\\n  0% {\\r\\n    -webkit-transform: scale(1);\\r\\n            transform: scale(1);\\r\\n  }\\r\\n  100% {\\r\\n    -webkit-transform: scale(0);\\r\\n            transform: scale(0);\\r\\n  }\\r\\n}\\r\\n@keyframes spinner3 {\\r\\n  0% {\\r\\n    -webkit-transform: scale(1);\\r\\n            transform: scale(1);\\r\\n  }\\r\\n  100% {\\r\\n    -webkit-transform: scale(0);\\r\\n            transform: scale(0);\\r\\n  }\\r\\n}\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<div class=\\\"maxSpace\\\" *ngIf=\\\"currentProgress\\\">\\r\\n  <div class=\\\"progressContainer\\\">\\r\\n    <div class=\\\"spinner\\\">\\r\\n      <div></div>\\r\\n      <div></div>\\r\\n      <div></div>\\r\\n      <div></div>\\r\\n    </div>\\r\\n    <div class=\\\"progressMessage\\\">{{currentProgress.message}}</div>\\r\\n  </div>\\r\\n</div>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit, OnDestroy } from '@angular/core';\r\nimport { ProgressObject, ProgressService } from '../progress.service';\r\nimport { Subscription } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-progress',\r\n  templateUrl: './progress.component.html',\r\n  styleUrls: ['./progress.component.css']\r\n})\r\nexport class ProgressComponent implements OnInit, OnDestroy {\r\n\r\n  currentProgress: ProgressObject = ProgressService.message('Loading');\r\n  private subscription: Subscription;\r\n\r\n  constructor(private progressSerivce: ProgressService) { }\r\n\r\n  ngOnInit() {\r\n    this.subscription = this.progressSerivce.getProgress().subscribe(this.updateProgress);\r\n  }\r\n\r\n  private updateProgress = (progress: ProgressObject) => {\r\n    this.currentProgress = progress;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.subscription) {\r\n      this.subscription.unsubscribe();\r\n    }\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { ConfigService } from './config.service';\r\nimport { Observable, Subscriber, Subscription } from 'rxjs';\r\n\r\nexport class Scannable {\r\n  private _priority: number;\r\n  private _type: string;\r\n\r\n  constructor(priority: number, type: string) {\r\n    this._priority = priority;\r\n    this._type = type;\r\n  }\r\n\r\n  get priority(): number {\r\n    return this._priority;\r\n  }\r\n\r\n  set priority(priority: number) {\r\n    this._priority = priority;\r\n  }\r\n\r\n  get type(): string {\r\n    return this._type;\r\n  }\r\n\r\n  set type(type: string) {\r\n    this._type = type;\r\n  }\r\n\r\n  hasChildren(): boolean {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport class ScannableCollection extends Scannable {\r\n  private children: Scannable[] = [];\r\n\r\n  hasChildren(): boolean {\r\n    return this.children.length > 0;\r\n  }\r\n\r\n  getChildren(): Scannable[] {\r\n    return this.children;\r\n  }\r\n\r\n  getChild(index: number): Scannable {\r\n    return this.children[index];\r\n  }\r\n\r\n  addChild(child: Scannable) {\r\n    this.children.push(child);\r\n    this.sortChildren();\r\n  }\r\n\r\n  addChildren(newChildren: Scannable[]) {\r\n    this.children.push(...newChildren);\r\n    this.sortChildren();\r\n  }\r\n\r\n  removeChildren(oldChildren: Scannable[]) {\r\n    oldChildren.forEach(scannable => {\r\n      const index = this.children.indexOf(scannable);\r\n      if (index >= 0) {\r\n        this.children.splice(index, 1);\r\n      }\r\n    });\r\n  }\r\n\r\n  sortChildren() {\r\n    this.children.sort(this._sortScannables);\r\n  }\r\n\r\n  _sortScannables(a: Scannable, b: Scannable): number {\r\n    return a.priority - b.priority;\r\n  }\r\n}\r\n\r\nexport class ScanningModel {\r\n  currentHighlight: Scannable;\r\n  currentSelection: Scannable;\r\n}\r\n\r\nexport interface ScannableCollectionProvider extends Subscriber<ScanningModel> {\r\n  getScannableCollections(): ScannableCollection[];\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ScanningService {\r\n\r\n  private topLevelScannables: ScannableCollection;\r\n  private currentCollection: ScannableCollection;\r\n  private scanningModel: ScanningModel;\r\n  private currentSelectedIndex = 0;\r\n  private observers: ScannableCollectionProvider[];\r\n  private intervalId;\r\n\r\n  constructor(private configService: ConfigService) {\r\n    this.topLevelScannables = new ScannableCollection(0, '');\r\n    this.currentCollection = this.topLevelScannables;\r\n    this.scanningModel = new ScanningModel();\r\n    this.observers = [];\r\n  }\r\n\r\n  getScanningModel(): Observable<ScanningModel> {\r\n    return new Observable<ScanningModel>(this.registerScannable);\r\n  }\r\n\r\n  registerScannable = (observer: ScannableCollectionProvider): Subscription => {\r\n    this.observers.push(observer);\r\n\r\n    this.topLevelScannables.addChildren(observer.getScannableCollections());\r\n\r\n    if (this.configService.scanningConfig.enabled) {\r\n      this.startScanning();\r\n    }\r\n\r\n    return new Subscription(() => this._unsubscribe(observer));\r\n  }\r\n\r\n  _unsubscribe(observer: ScannableCollectionProvider) {\r\n    if (this.observers.includes(observer)) {\r\n      this.observers.splice(this.observers.indexOf(observer), 1);\r\n    }\r\n    this.topLevelScannables.removeChildren(observer.getScannableCollections());\r\n\r\n    this.currentCollection = this.topLevelScannables;\r\n\r\n    if (this.observers.length === 0) {\r\n      this.stopScanning();\r\n      this.scanningModel = new ScanningModel();\r\n    }\r\n  }\r\n\r\n  handleInteraction() {\r\n    if (this.scanningModel.currentHighlight) {\r\n      this.updateSelected();\r\n\r\n      if (this.scanningModel.currentSelection.hasChildren()) {\r\n        this.currentCollection = <ScannableCollection> this.scanningModel.currentSelection;\r\n      } else {\r\n        this.currentCollection = this.topLevelScannables;\r\n      }\r\n    }\r\n  }\r\n\r\n  private startScanning() {\r\n    if (this.intervalId === undefined && this.observers.length >= 1) {\r\n      document.onkeydown = this.handleInteraction.bind(this);\r\n      this.currentSelectedIndex = 0;\r\n      this.intervalId = setInterval(this.updateHighlighted, this.configService.scanningConfig.time);\r\n    }\r\n  }\r\n\r\n  private stopScanning() {\r\n    document.onkeydown = undefined;\r\n    clearInterval(this.intervalId);\r\n    this.intervalId = undefined;\r\n  }\r\n\r\n  private updateHighlighted = () => {\r\n    if (this.currentSelectedIndex >= this.currentCollection.getChildren().length) {\r\n      this.currentSelectedIndex = 0;\r\n    }\r\n\r\n    this.scanningModel.currentHighlight = this.currentCollection.getChild(this.currentSelectedIndex++);\r\n    this.notifyObservers();\r\n  }\r\n\r\n  private updateSelected = () => {\r\n    this.stopScanning();\r\n    const current = this.scanningModel.currentHighlight;\r\n    this.scanningModel.currentSelection = current;\r\n    this.scanningModel.currentHighlight = undefined;\r\n    this.notifyObservers();\r\n\r\n    // stay on the selection for one [time] then clear selection and restart scanning\r\n    setTimeout(() => {\r\n      this.scanningModel.currentSelection = undefined;\r\n      this.notifyObservers();\r\n      this.startScanning();\r\n    }, this.configService.scanningConfig.time);\r\n  }\r\n\r\n  private notifyObservers() {\r\n    this.observers.forEach(observer => observer.next(this.scanningModel));\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Injectable } from '@angular/core';\r\nimport { Button, Image, OBFBoard, LoadBoardAction } from './obfboard';\r\nimport { Observable, Observer } from 'rxjs';\r\nimport { ConfigService } from './config.service';\r\n\r\nexport class ButtonFacade extends Button {\r\n\r\n  private button: Button;\r\n  private appendages: string[] = [];\r\n\r\n  constructor(button: Button) {\r\n    super();\r\n    this.button = button;\r\n  }\r\n\r\n  append(appendage: string) {\r\n    this.appendages.push(appendage);\r\n  }\r\n\r\n  getVocalization(): string {\r\n    return this.vocalization || this.label;\r\n  }\r\n\r\n  getImage(): Image {\r\n    return this.button.getImage();\r\n  }\r\n\r\n  private augment(initial: string): string {\r\n    return [initial].concat(this.appendages).join('');\r\n  }\r\n\r\n  get id(): string {\r\n    return this.button.id;\r\n  }\r\n\r\n  get label(): string {\r\n    return this.augment(this.button.label);\r\n  }\r\n\r\n  get vocalization(): string {\r\n    return this.button.vocalization ? this.augment(this.button.vocalization) : this.button.vocalization;\r\n  }\r\n\r\n  get imageId(): string {\r\n    return this.button.imageId;\r\n  }\r\n\r\n  get soundId(): string {\r\n    return this.button.soundId;\r\n  }\r\n\r\n  get backgroundColor(): string {\r\n    return this.button.backgroundColor;\r\n  }\r\n\r\n  get borderColor(): string {\r\n    return this.button.borderColor;\r\n  }\r\n\r\n  get actions(): string[] {\r\n    return this.button.actions;\r\n  }\r\n\r\n  get loadBoardAction(): LoadBoardAction {\r\n    return this.button.loadBoardAction;\r\n  }\r\n\r\n  get parent(): OBFBoard {\r\n    return this.button.parent;\r\n  }\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SpeechbarService {\r\n\r\n  private buttons: ButtonFacade[] = [];\r\n  private speechSynthesizer: SpeechSynthesis = (<any>window).speechSynthesis;\r\n  private listener: Observer<boolean>;\r\n  private buttonObserver: Observer<Button[]>;\r\n  private spaceJustPressed = false;\r\n  private userVoice: SpeechSynthesisVoice;\r\n\r\n  constructor(private configService: ConfigService) {\r\n    this.configService.voiceConfig$.subscribe(\r\n      voiceConfig => {\r\n        if (voiceConfig.userVoice) {\r\n          this.userVoice = this.speechSynthesizer.getVoices().find(voice => voice.voiceURI === voiceConfig.userVoice);\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  addButton(button: Button) {\r\n    this.spaceJustPressed = false;\r\n    this.buttons.push(new ButtonFacade(button));\r\n    this.notifyButtonObserver();\r\n  }\r\n\r\n  clear() {\r\n    this.buttons = [];\r\n    this.notifyButtonObserver();\r\n  }\r\n\r\n  backspace() {\r\n    this.buttons.pop();\r\n    this.notifyButtonObserver();\r\n  }\r\n\r\n  speak() {\r\n    // don't queue up multiple speak actions\r\n    if (!this.speechSynthesizer.speaking) {\r\n      const msg = this.createUtterance();\r\n      msg.text = this.buildSentence(this.buttons.map(button => button.getVocalization()));\r\n\r\n      msg.onstart = () => this.listener.next(true);\r\n      msg.onend = () => this.listener.next(false);\r\n      this.speechSynthesizer.speak(msg);\r\n    }\r\n  }\r\n\r\n  buildSentence(vocalizations: string[]): string {\r\n    if (vocalizations.length === 0) {\r\n      return '';\r\n    }\r\n    const ret = vocalizations.join(' ');\r\n    const lastChar = ret[ret.length - 1];\r\n    const endsWithPunc = lastChar === '?' || lastChar === '!' || lastChar === '.';\r\n    return endsWithPunc ? ret : ret + ' .';\r\n  }\r\n\r\n  sayButton(button: Button) {\r\n    // we do want to queue these up, so no speaking check\r\n    // we also want the speak button to stay enabled for queing up the actual message, so no listener updates\r\n    const msg = this.createUtterance();\r\n    msg.text = this.buildSentence([button.getVocalization()]);\r\n    this.speechSynthesizer.speak(msg);\r\n  }\r\n\r\n  private createUtterance(): any {\r\n    const msg = new SpeechSynthesisUtterance();\r\n\r\n    if (this.userVoice) {\r\n      msg.voice = this.userVoice;\r\n    }\r\n\r\n    return msg;\r\n  }\r\n\r\n  appendButton(button: Button, action: string) {\r\n    if (this.buttons.length === 0 || this.spaceJustPressed) {\r\n      this.spaceJustPressed = false;\r\n      const appendBut = new Button();\r\n      appendBut.label = action.substr(1);\r\n      this.buttons.push(new ButtonFacade(appendBut));\r\n      this.notifyButtonObserver();\r\n    } else {\r\n      this.spaceJustPressed = false;\r\n      this.buttons[this.buttons.length - 1].append(action.substr(1));\r\n      this.notifyButtonObserver();\r\n    }\r\n  }\r\n\r\n  space() {\r\n    this.spaceJustPressed = true;\r\n  }\r\n\r\n  private notifyButtonObserver() {\r\n    this.buttonObserver.next(this.buttons);\r\n  }\r\n\r\n  getButtons(): Observable<Button[]> {\r\n    return new Observable<Button[]>(this.addButtonObserver);\r\n  }\r\n\r\n  getSpeaking(): Observable<boolean> {\r\n    return new Observable<boolean>(this.addListener);\r\n  }\r\n\r\n  addButtonObserver = (observer: Observer<Button[]>) => {\r\n    this.buttonObserver = observer;\r\n    this.buttonObserver.next(this.buttons);\r\n  }\r\n\r\n  addListener = (listener: Observer<boolean>) => {\r\n    this.listener = listener;\r\n    this.listener.next(this.speechSynthesizer && this.speechSynthesizer.speaking);\r\n  }\r\n}\r\n","module.exports = \"/* ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: */\\r\\n.speechbarContainer {\\r\\n  display: flex;\\r\\n  height: 100%;\\r\\n}\\r\\n.speechbar {\\r\\n  display: flex;\\r\\n  overflow-x: scroll;\\r\\n  overflow-y: hidden;\\r\\n  flex-grow: 1;\\r\\n  padding: 0;\\r\\n}\\r\\n.speechbarTextItem {\\r\\n  flex-shrink: 0;\\r\\n}\\r\\n.speechbarButtonItem {\\r\\n  min-height: 33%;\\r\\n  max-width: 20%;\\r\\n  min-width: 10%;\\r\\n}\\r\\n.speechbarText {\\r\\n  padding: 12px;\\r\\n  height: 100%;\\r\\n  font-size: x-large;\\r\\n}\\r\\n.stackedButtonContainer {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n}\\r\\n.stackedButton {\\r\\n  flex-grow: 1;\\r\\n  padding-top: 30%;\\r\\n  background: var(--button-image) no-repeat 50% 35%;\\r\\n  background-size: auto 25%;\\r\\n}\\r\\n.scanHighlight {\\r\\n  position: relative;\\r\\n}\\r\\n.scanHighlight:after {\\r\\n  border: greenyellow solid 5px;\\r\\n  content: \\\" \\\";\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n  bottom: 0;\\r\\n}\\r\\n.scanSelect {\\r\\n  position: relative;\\r\\n}\\r\\n.scanSelect:after {\\r\\n  border: blue solid 5px;\\r\\n  content: \\\" \\\";\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n  bottom: 0;\\r\\n}\\r\\n\"","module.exports = \"<!-- ::START::LICENCE::\\r\\nCopyright eQualityTime ©2018\\r\\nThis file is part of OVFPlayer.\\r\\nOVFPlayer is free software: you can redistribute it and/or modify\\r\\nit under the terms of the GNU General Public License as published by\\r\\nthe Free Software Foundation, either version 3 of the License, or\\r\\n(at your option) any later version.\\r\\nOVFPlayer is distributed in the hope that it will be useful,\\r\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\r\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\r\\nGNU General Public License for more details.\\r\\nYou should have received a copy of the GNU General Public License\\r\\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\\r\\n::END::LICENCE:: -->\\r\\n<div class=\\\"speechbarContainer\\\"\\r\\n    [class.scanHighlight]=\\\"buttonRow.isHighlighted()\\\"\\r\\n    [class.scanSelect]=\\\"buttonRow.isSelected()\\\">\\r\\n  <div class=\\\"stackedButtonContainer\\\">\\r\\n    <button class=\\\"stackedButton\\\" mat-raised-button [appInteractionEventHandler]=\\\"buttonRow.speak.handler\\\" [disabled]=\\\"speaking\\\"\\r\\n            [class.scanHighlight]=\\\"buttonRow.speak.isHighlighted()\\\"\\r\\n            [class.scanSelect]=\\\"buttonRow.speak.isSelected()\\\"\\r\\n            style=\\\"--button-image: url('/assets/images/speechbubble.png')\\\"\\r\\n            *ngIf=\\\"buttonRow.speak\\\">{{buttonRow.speak.label}}</button>\\r\\n    <button class=\\\"stackedButton\\\" mat-raised-button [appInteractionEventHandler]=\\\"buttonRow.home.handler\\\"\\r\\n            [class.scanHighlight]=\\\"buttonRow.home.isHighlighted()\\\"\\r\\n            [class.scanSelect]=\\\"buttonRow.home.isSelected()\\\"\\r\\n            style=\\\"--button-image: url('/assets/images/home.png')\\\"\\r\\n            *ngIf=\\\"buttonRow.home\\\">{{buttonRow.home.label}}</button>\\r\\n  </div>\\r\\n\\r\\n  <mat-card class=\\\"speechbar\\\" *ngIf=\\\"showIconsInSpeechbar; else vocalization\\\"\\r\\n            [appInteractionEventHandler]=\\\"buttonRow.speechbar && buttonRow.speechbar.handler\\\"\\r\\n            [class.scanHighlight]=\\\"buttonRow.speechbar && buttonRow.speechbar.isHighlighted()\\\"\\r\\n            [class.scanSelect]=\\\"buttonRow.speechbar && buttonRow.speechbar.isSelected()\\\">\\r\\n    <div class=\\\"speechbarButtonItem\\\" *ngFor=\\\"let butt of buttons\\\">\\r\\n      <app-obf-button [butt]=\\\"butt\\\"></app-obf-button>\\r\\n    </div>\\r\\n  </mat-card>\\r\\n  <ng-template #vocalization>\\r\\n    <mat-card class=\\\"speechbar\\\" [appInteractionEventHandler]=\\\"buttonRow.speechbar && buttonRow.speechbar.handler\\\"\\r\\n              [class.scanHighlight]=\\\"buttonRow.speechbar && buttonRow.speechbar.isHighlighted()\\\"\\r\\n              [class.scanSelect]=\\\"buttonRow.speechbar && buttonRow.speechbar.isSelected()\\\">\\r\\n      <div class=\\\"speechbarTextItem\\\" *ngFor=\\\"let butt of buttons\\\">\\r\\n        <mat-card class=\\\"speechbarText\\\">\\r\\n          {{butt.getVocalization()}}\\r\\n        </mat-card>\\r\\n      </div>\\r\\n    </mat-card>\\r\\n  </ng-template>\\r\\n\\r\\n  <div class=\\\"stackedButtonContainer\\\">\\r\\n    <button class=\\\"stackedButton\\\" mat-raised-button [appInteractionEventHandler]=\\\"buttonRow.backspace.handler\\\"\\r\\n            [class.scanHighlight]=\\\"buttonRow.backspace.isHighlighted()\\\"\\r\\n            [class.scanSelect]=\\\"buttonRow.backspace.isSelected()\\\"\\r\\n            style=\\\"--button-image: url('/assets/images/left.png')\\\"\\r\\n            *ngIf=\\\"buttonRow.backspace\\\">{{buttonRow.backspace.label}}</button>\\r\\n    <button class=\\\"stackedButton\\\" mat-raised-button [appInteractionEventHandler]=\\\"buttonRow.clear.handler\\\"\\r\\n            [class.scanHighlight]=\\\"buttonRow.clear.isHighlighted()\\\"\\r\\n            [class.scanSelect]=\\\"buttonRow.clear.isSelected()\\\"\\r\\n            style=\\\"--button-image: url('/assets/images/erase.png')\\\"\\r\\n            *ngIf=\\\"buttonRow.clear\\\">{{buttonRow.clear.label}}</button>\\r\\n  </div>\\r\\n</div>\\r\\n\"","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { Component, OnInit, ChangeDetectorRef, OnDestroy } from '@angular/core';\r\nimport { ConfigService, ButtonDisplayConfig } from '../config.service';\r\nimport { SpeechbarService } from '../speechbar.service';\r\nimport { Subscription, Subscriber } from 'rxjs';\r\nimport { BoardService } from '../board.service';\r\nimport { Button } from '../obfboard';\r\nimport { ScanningService, ScanningModel, Scannable, ScannableCollection, ScannableCollectionProvider } from '../scanning.service';\r\n\r\nclass ScannableButton extends Scannable {\r\n  static TYPE = 'SpeechbarButton';\r\n  private _label: string;\r\n  private _handler: () => void;\r\n  private speechbarComponent: SpeechbarComponent;\r\n\r\n  constructor(label: string, handler: () => void, priority: number, speechbarComponent: SpeechbarComponent) {\r\n    super(priority, ScannableButton.TYPE);\r\n    this._label = label;\r\n    this._handler = handler;\r\n    this.speechbarComponent = speechbarComponent;\r\n  }\r\n\r\n  get label(): string {\r\n    return this._label;\r\n  }\r\n\r\n  get handler(): () => void {\r\n    return this._handler;\r\n  }\r\n\r\n  set label(label: string) {\r\n    this._label = label;\r\n  }\r\n\r\n  set handler(handler: () => void) {\r\n    this._handler = handler;\r\n  }\r\n\r\n  isHighlighted(): boolean {\r\n    return this.speechbarComponent.scanningModel && this.speechbarComponent.scanningModel.currentHighlight === this;\r\n  }\r\n\r\n  isSelected(): boolean {\r\n    return this.speechbarComponent.scanningModel && this.speechbarComponent.scanningModel.currentSelection === this;\r\n  }\r\n}\r\n\r\nclass ScannableSpeechbarRow extends ScannableCollection {\r\n  static TYPE = 'SpeechbarRow';\r\n  speak: ScannableButton;\r\n  home: ScannableButton;\r\n  speechbar: ScannableButton;\r\n  backspace: ScannableButton;\r\n  clear: ScannableButton;\r\n  private speechbarComponent: SpeechbarComponent;\r\n\r\n  constructor(displayedButtons: ButtonDisplayConfig, speakOnSpeechbarClick: boolean, speechbarComponent: SpeechbarComponent) {\r\n    super(0, ScannableSpeechbarRow.TYPE);\r\n    this.speechbarComponent = speechbarComponent;\r\n\r\n    if (displayedButtons.showSpeakButton) {\r\n      this.speak = new ScannableButton('Speak', speechbarComponent.speak.bind(speechbarComponent), 0, speechbarComponent);\r\n      this.addChild(this.speak);\r\n    }\r\n    if (displayedButtons.showHomeButton) {\r\n      this.home = new ScannableButton('Home', speechbarComponent.home.bind(speechbarComponent), 1, speechbarComponent);\r\n      this.addChild(this.home);\r\n    }\r\n    if (speakOnSpeechbarClick) {\r\n      this.speechbar = new ScannableButton('speechbar', speechbarComponent.speechbarClick.bind(speechbarComponent), 2, speechbarComponent);\r\n      this.addChild(this.speechbar);\r\n    }\r\n    if (displayedButtons.showBackspaceButton) {\r\n      this.backspace = new ScannableButton('Backspace', speechbarComponent.backspace.bind(speechbarComponent), 3, speechbarComponent);\r\n      this.addChild(this.backspace);\r\n    }\r\n    if (displayedButtons.showClearButton) {\r\n      this.clear = new ScannableButton('Clear', speechbarComponent.clear.bind(speechbarComponent), 4, speechbarComponent);\r\n      this.addChild(this.clear);\r\n    }\r\n  }\r\n\r\n  isHighlighted(): boolean {\r\n    return this.speechbarComponent.scanningModel && this.speechbarComponent.scanningModel.currentHighlight === this;\r\n  }\r\n\r\n  isSelected(): boolean {\r\n    return this.speechbarComponent.scanningModel && this.speechbarComponent.scanningModel.currentSelection === this;\r\n  }\r\n}\r\n\r\nclass ScannableSpeechbarProvider extends Subscriber<ScanningModel> implements ScannableCollectionProvider {\r\n  private rows: ScannableSpeechbarRow[];\r\n\r\n  constructor(displayedButtons: ButtonDisplayConfig, speakOnSpeechbarClick: boolean, speechbarComponent: SpeechbarComponent) {\r\n    super((scanningModel: ScanningModel) => {\r\n      speechbarComponent.scanningModel = scanningModel;\r\n\r\n      if (speechbarComponent.scanningModel.currentSelection &&\r\n        speechbarComponent.scanningModel.currentSelection.type === ScannableButton.TYPE) {\r\n        (<ScannableButton>speechbarComponent.scanningModel.currentSelection).handler();\r\n      }\r\n    });\r\n    this.rows = [new ScannableSpeechbarRow(displayedButtons, speakOnSpeechbarClick, speechbarComponent)];\r\n  }\r\n\r\n  getScannableCollections(): ScannableCollection[] {\r\n    return this.rows;\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: 'app-speechbar',\r\n  templateUrl: './speechbar.component.html',\r\n  styleUrls: ['./speechbar.component.css']\r\n})\r\nexport class SpeechbarComponent implements OnInit, OnDestroy {\r\n  private _displayedButtons: ButtonDisplayConfig;\r\n  private _showIconsInSpeechbar: boolean;\r\n  private speakingSubscription: Subscription;\r\n  private buttonsSubscription: Subscription;\r\n  private scanningSubscription: Subscription;\r\n  speaking: boolean;\r\n  buttons: Button[];\r\n  scanningModel: ScanningModel;\r\n  buttonRow: ScannableSpeechbarRow;\r\n\r\n  constructor(\r\n    private boardService: BoardService,\r\n    private speechbarService: SpeechbarService,\r\n    private config: ConfigService,\r\n    private scanningService: ScanningService,\r\n    private cdRef: ChangeDetectorRef\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this._displayedButtons = this.config.displayedButtons;\r\n    this._showIconsInSpeechbar = this.config.showIconsInSpeechbar;\r\n    const provider = new ScannableSpeechbarProvider(this._displayedButtons, this.config.speakOnSpeechbarClick, this);\r\n    this.buttonRow = <ScannableSpeechbarRow> provider.getScannableCollections()[0];\r\n    this.scanningSubscription = this.scanningService.getScanningModel().subscribe(provider);\r\n    this.speakingSubscription = this.speechbarService.getSpeaking().subscribe(speaking => {\r\n      this.speaking = speaking;\r\n      this.cdRef.detectChanges();\r\n    });\r\n    this.buttonsSubscription = this.speechbarService.getButtons().subscribe(buttons => {\r\n      this.buttons = buttons;\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.speakingSubscription) {\r\n      this.speakingSubscription.unsubscribe();\r\n    }\r\n    if (this.buttonsSubscription) {\r\n      this.buttonsSubscription.unsubscribe();\r\n    }\r\n    if (this.scanningSubscription) {\r\n      this.scanningSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  get displayedButtons(): ButtonDisplayConfig {\r\n    return this._displayedButtons;\r\n  }\r\n\r\n  get showIconsInSpeechbar(): boolean {\r\n    return this._showIconsInSpeechbar;\r\n  }\r\n\r\n  speechbarClick() {\r\n    if (this.config.speakOnSpeechbarClick) {\r\n      this.speechbarService.speak();\r\n    }\r\n  }\r\n\r\n  speak() {\r\n    this.speechbarService.speak();\r\n  }\r\n\r\n  home() {\r\n    this.boardService.home();\r\n  }\r\n\r\n  backspace() {\r\n    this.speechbarService.backspace();\r\n  }\r\n\r\n  clear() {\r\n    this.speechbarService.clear();\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport * as urlParse from 'url-parse';\r\n\r\nexport class UrlUtils {\r\n  public getSlug(url: string): string {\r\n    const pathname = this.getPathname(url);\r\n    const bits = pathname.split('/');\r\n    return bits.pop();\r\n  }\r\n\r\n  public getPathname(url: string): string {\r\n    return urlParse(url).pathname;\r\n  }\r\n}\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\n// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build ---prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * In development mode, to ignore zone related error stack frames such as\r\n * `zone.run`, `zoneDelegate.invokeTask` for easier debugging, you can\r\n * import the following file, but please comment it out in production mode\r\n * because it will have performance impact when throw error\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","// IMPORTANT: THIS FILE IS AUTO GENERATED! DO NOT MANUALLY EDIT OR CHECKIN!\r\n/* tslint:disable */\r\nexport const VERSION = {\r\n    \"tag\": \"DEV ONLY\"\r\n};\r\n/* tslint:enable */\r\n","/* ::START::LICENCE::\r\nCopyright eQualityTime ©2018\r\nThis file is part of OVFPlayer.\r\nOVFPlayer is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License as published by\r\nthe Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\nOVFPlayer is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License\r\nalong with OVFPlayer.  If not, see <https://www.gnu.org/licenses/>.\r\n::END::LICENCE:: */\r\nimport { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic()\r\n  .bootstrapModule(AppModule)\r\n  .then(() => {\r\n    registerServiceWorker('service-worker');\r\n  });\r\n\r\nfunction registerServiceWorker(swName: string) {\r\n  if (environment.production && 'serviceWorker' in navigator) {\r\n    navigator.serviceWorker\r\n      .register(`/ovfplayer/${swName}.js`)\r\n      .then(reg => {\r\n        console.log('Successful service worker registration', reg);\r\n      })\r\n      .catch(err =>\r\n        console.error('Service worker registration failed', err)\r\n      );\r\n  } else if (environment.production) {\r\n    console.error('Service Worker API is not supported in current browser');\r\n  }\r\n}\r\n"],"sourceRoot":""}